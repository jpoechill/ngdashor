function parseCSV(e){for(var t=[],r=!1,a=col=c=0;c<e.length;c++){var n=e[c],o=e[c+1];t[a]=t[a]||[],t[a][col]=t[a][col]||"",'"'==n&&r&&'"'==o?(t[a][col]+=n,++c):'"'!=n?","!=n||r?"\n"!=n||r?t[a][col]+=n:(++a,col=0):++col:r=!r}return t}function convertToJSON(e){for(var t=e[0],r=e[1],a={},n=0;n<t.length;n++){var o=t[n].split("/")[0];a.hasOwnProperty(o)?a[o].push(r[n]):a[o]=[r[n]]}return[a]}var app=angular.module("dashor",["ngRoute","smart-table","chart.js","leaflet-directive"]);app.config(function(e){e.debugEnabled(!1)}),app.config(function(e,t){e.when("/",{templateUrl:"views/main.html",controller:"MainController"}).when("/employees",{templateUrl:"views/map.html",controller:"MapController"}).when("/keymetrics",{templateUrl:"views/keymetrics.html"}).when("/dataview",{templateUrl:"views/dataview.html",controller:"DataController"})}),app.controller("DataController",["$scope","$http","$interval",function(e,t,r){function a(){t.get("data/json/issues.json").then(function(t){Array.prototype.splice.apply(e.rowCollection,[0,e.rowCollection.length].concat(t.data))}).catch(function(e){console.log("Error "+e)})}e.rowCollection=[],e.displayedCollection=[].concat(e.rowCollection),e.itemsByPage=2,a(),r(a,5e3,0),e.showStatus=function(e){if("Open"==e)return!0}}]),app.controller("MainController",["$scope","$interval",function(e,t){}]),app.controller("MapController",["$scope","$http","$interval",function(e,t,r){angular.extend(e,{defaults:{scrollWheelZoom:!1,zoomControl:!1},center:{lat:39.833,lng:-90.583,zoom:4},tiles:{url:"http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",options:{attribution:'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="http://mapbox.com">Mapbox</a>'}},markers:{}});var a=function(){t.get("data/json/mapping.json").then(function(t){e.data=t.data,n()}).catch(function(e){console.log("Error "+e)})};a(),r(a,3e3,0);var n=function(){e.data.filter(function(t){e.markers[t.shortname]={title:t.name,lat:t.coords[0],lng:t.coords[1],message:t.name+"<br><span style='font-size: 12px; font-weight: 600;'>"+t.employees+" Employees</span>"}})}}]),function(e){"use strict";if("object"==typeof exports)module.exports=e("undefined"!=typeof angular?angular:require("angular"),"undefined"!=typeof Chart?Chart:require("chart.js"));else if("function"==typeof define&&define.amd)define(["angular","chart"],e);else{if("undefined"==typeof angular||"undefined"==typeof Chart)throw new Error("Chart.js library needs to be included, see http://jtblin.github.io/angular-chart.js/");e(angular,Chart)}}(function(e,t){"use strict";function r(){var r={responsive:!0},a={Chart:t,getOptions:function(t){var a=t&&r[t]||{};return e.extend({},r,a)}};this.setOptions=function(t,n){n?r[t]=e.merge(r[t]||{},n):(n=t,r=e.merge(r,n)),e.merge(a.Chart.defaults,r)},this.$get=function(){return a}}function a(r,a){function o(e,t,a){var n=C(e,t);if(y(t)&&D(e,t,a,n)){var o=a[0],i=o.getContext("2d");t.chartGetColor=h(t);var l=m(e,t);A(t),t.chart=new r.Chart(i,{type:e,data:l,options:n}),t.$emit("chart-create",t.chart),P(o,t)}}function i(e,t){return!!(e&&t&&e.length&&t.length)&&(Array.isArray(e[0])?e.length===t.length&&e.every(function(e,r){return e.length===t[r].length}):t.reduce(l,0)>0&&e.length===t.length)}function l(e,t){return e+t}function s(t,r,a){var n=null;return function(o){var i=t.chart.getElementsAtEvent||t.chart.getPointsAtEvent;if(i){var l=i.call(t.chart,o);a!==!1&&e.equals(n,l)!==!1||(n=l,t[r](l,o))}}}function c(a,n){for(var o=e.copy(n.chartColors||r.getOptions(a).chartColors||t.defaults.global.colors),i=o.length<n.chartData.length;o.length<n.chartData.length;)o.push(n.chartGetColor());return i&&(n.chartColors=o),o.map(u)}function u(e){return"object"==typeof e&&null!==e?e:"string"==typeof e&&"#"===e[0]?f(v(e.substr(1))):d()}function d(){var e=[p(0,255),p(0,255),p(0,255)];return f(e)}function f(e){return{backgroundColor:g(e,.2),pointBackgroundColor:g(e,1),pointHoverBackgroundColor:g(e,.8),borderColor:g(e,1),pointBorderColor:"#fff",pointHoverBorderColor:g(e,1)}}function p(e,t){return Math.floor(Math.random()*(t-e+1))+e}function g(e,t){return n?"rgb("+e.join(",")+")":"rgba("+e.concat(t).join(",")+")"}function v(e){var t=parseInt(e,16),r=t>>16&255,a=t>>8&255,n=255&t;return[r,a,n]}function y(e){return e.chartData&&e.chartData.length}function h(e){return"function"==typeof e.chartGetColor?e.chartGetColor:d}function m(e,t){var r=c(e,t);return Array.isArray(t.chartData[0])?L(t.chartLabels,t.chartData,t.chartSeries||[],r,t.chartDatasetOverride):b(t.chartLabels,t.chartData,r,t.chartDatasetOverride)}function L(t,r,a,n,o){return{labels:t,datasets:r.map(function(t,r){var i=e.extend({},n[r],{label:a[r],data:t});return o&&o.length>=r&&e.merge(i,o[r]),i})}}function b(t,r,a,n){var o={labels:t,datasets:[{data:r,backgroundColor:a.map(function(e){return e.pointBackgroundColor}),hoverBackgroundColor:a.map(function(e){return e.backgroundColor})}]};return n&&e.merge(o.datasets[0],n),o}function C(t,a){return e.extend({},r.getOptions(t),a.chartOptions)}function P(t,r){t.onclick=r.chartClick?s(r,"chartClick",!1):e.noop,t.onmousemove=r.chartHover?s(r,"chartHover",!0):e.noop}function k(e,t){Array.isArray(t.chartData[0])?t.chart.data.datasets.forEach(function(t,r){t.data=e[r]}):t.chart.data.datasets[0].data=e,t.chart.update(),t.$emit("chart-update",t.chart)}function w(e){return!e||Array.isArray(e)&&!e.length||"object"==typeof e&&!Object.keys(e).length}function D(e,t,r,n){return!n.responsive||0!==r[0].clientHeight||(a(function(){o(e,t,r)},50,!1),!1)}function A(e){e.chart&&(e.chart.destroy(),e.$emit("chart-destroy",e.chart))}return function(t){return{restrict:"CA",scope:{chartGetColor:"=?",chartType:"=",chartData:"=?",chartLabels:"=?",chartOptions:"=?",chartSeries:"=?",chartColors:"=?",chartClick:"=?",chartHover:"=?",chartDatasetOverride:"=?"},link:function(r,a){function l(e,n){if(!e||!e.length||Array.isArray(e[0])&&!e[0].length)return void A(r);var l=t||r.chartType;if(l)return r.chart&&i(e,n)?k(e,r):void o(l,r,a)}function s(n,i){if(!w(n)&&!e.equals(n,i)){var l=t||r.chartType;l&&o(l,r,a)}}function c(t,n){w(t)||e.equals(t,n)||o(t,r,a)}n&&window.G_vmlCanvasManager.initElement(a[0]),r.$watch("chartData",l,!0),r.$watch("chartSeries",s,!0),r.$watch("chartLabels",s,!0),r.$watch("chartOptions",s,!0),r.$watch("chartColors",s,!0),r.$watch("chartDatasetOverride",s,!0),r.$watch("chartType",c,!1),r.$on("$destroy",function(){A(r)}),r.$on("$resize",function(){r.chart&&r.chart.resize()})}}}}t.defaults.global.multiTooltipTemplate="<%if (datasetLabel){%><%=datasetLabel%>: <%}%><%= value %>",t.defaults.global.tooltips.mode="label",t.defaults.global.elements.line.borderWidth=2,t.defaults.global.elements.rectangle.borderWidth=2,t.defaults.global.legend.display=!1,t.defaults.global.colors=["#97BBCD","#DCDCDC","#F7464A","#46BFBD","#FDB45C","#949FB1","#4D5360"];var n="object"==typeof window.G_vmlCanvasManager&&null!==window.G_vmlCanvasManager&&"function"==typeof window.G_vmlCanvasManager.initElement;return n&&(t.defaults.global.animation=!1),e.module("chart.js",[]).provider("ChartJs",r).factory("ChartJsFactory",["ChartJs","$timeout",a]).directive("chartBase",["ChartJsFactory",function(e){return new e}]).directive("chartLine",["ChartJsFactory",function(e){return new e("line")}]).directive("chartBar",["ChartJsFactory",function(e){return new e("bar")}]).directive("chartHorizontalBar",["ChartJsFactory",function(e){return new e("horizontalBar")}]).directive("chartRadar",["ChartJsFactory",function(e){return new e("radar")}]).directive("chartDoughnut",["ChartJsFactory",function(e){return new e("doughnut")}]).directive("chartPie",["ChartJsFactory",function(e){return new e("pie")}]).directive("chartPolarArea",["ChartJsFactory",function(e){return new e("polarArea")}]).directive("chartBubble",["ChartJsFactory",function(e){return new e("bubble")}]).name}),function(angular){"use strict";!function(angular){angular.module("leaflet-directive",[]).directive("leaflet",["$q","leafletData","leafletMapDefaults","leafletHelpers","leafletMapEvents",function(e,t,r,a,n){return{restrict:"EA",replace:!0,scope:{center:"=",lfCenter:"=",defaults:"=",maxbounds:"=",bounds:"=",markers:"=",legend:"=",geojson:"=",paths:"=",tiles:"=",layers:"=",controls:"=",decorations:"=",eventBroadcast:"=",markersWatchOptions:"=",geojsonWatchOptions:"="},transclude:!0,template:'<div class="angular-leaflet-map"><div ng-transclude></div></div>',controller:["$scope",function(t){this._leafletMap=e.defer(),this.getMap=function(){return this._leafletMap.promise},this.getLeafletScope=function(){return t}}],link:function(e,o,i,l){function s(){isNaN(i.width)?o.css("width",i.width):o.css("width",i.width+"px")}function c(){isNaN(i.height)?o.css("height",i.height):o.css("height",i.height+"px")}var u=a.isDefined,d=r.setDefaults(e.defaults,i.id),f=n.getAvailableMapEvents(),p=n.addEvents;e.mapId=i.id,t.setDirectiveControls({},i.id),u(i.width)&&(s(),e.$watch(function(){return o[0].getAttribute("width")},function(){s(),g.invalidateSize()})),u(i.height)&&(c(),e.$watch(function(){return o[0].getAttribute("height")},function(){c(),g.invalidateSize()}));var g=new L.Map(o[0],r.getMapCreationDefaults(i.id));if(l._leafletMap.resolve(g),u(i.center)||u(i.lfCenter)||g.setView([d.center.lat,d.center.lng],d.center.zoom),!u(i.tiles)&&!u(i.layers)){var v=L.tileLayer(d.tileLayer,d.tileLayerOptions);v.addTo(g),t.setTiles(v,i.id)}if(u(g.zoomControl)&&u(d.zoomControlPosition)&&g.zoomControl.setPosition(d.zoomControlPosition),u(g.zoomControl)&&d.zoomControl===!1&&g.zoomControl.removeFrom(g),u(g.zoomsliderControl)&&u(d.zoomsliderControl)&&d.zoomsliderControl===!1&&g.zoomsliderControl.removeFrom(g),!u(i.eventBroadcast)){var y="broadcast";p(g,f,"eventName",e,y)}g.whenReady(function(){t.setMap(g,i.id)}),e.$on("$destroy",function(){r.reset(),g.remove(),t.unresolveMap(i.id)}),e.$on("invalidateSize",function(){g.invalidateSize()})}}}]),angular.module("leaflet-directive").factory("leafletBoundsHelpers",["$log","leafletHelpers",function(e,t){function r(e){return angular.isDefined(e)&&angular.isDefined(e.southWest)&&angular.isDefined(e.northEast)&&angular.isNumber(e.southWest.lat)&&angular.isNumber(e.southWest.lng)&&angular.isNumber(e.northEast.lat)&&angular.isNumber(e.northEast.lng)}var a=t.isArray,n=t.isNumber,o=t.isFunction,i=t.isDefined;return{createLeafletBounds:function(e){return r(e)?L.latLngBounds([e.southWest.lat,e.southWest.lng],[e.northEast.lat,e.northEast.lng]):void 0},isValidBounds:r,createBoundsFromArray:function(t){return a(t)&&2===t.length&&a(t[0])&&a(t[1])&&2===t[0].length&&2===t[1].length&&n(t[0][0])&&n(t[0][1])&&n(t[1][0])&&n(t[1][1])?{northEast:{lat:t[0][0],lng:t[0][1]},southWest:{lat:t[1][0],lng:t[1][1]}}:void e.error("[AngularJS - Leaflet] The bounds array is not valid.")},createBoundsFromLeaflet:function(t){if(!(i(t)&&o(t.getNorthEast)&&o(t.getSouthWest)))return void e.error("[AngularJS - Leaflet] The leaflet bounds is not valid object.");var r=t.getNorthEast(),a=t.getSouthWest();return{northEast:{lat:r.lat,lng:r.lng},southWest:{lat:a.lat,lng:a.lng}}}}}]),angular.module("leaflet-directive").factory("leafletControlHelpers",["$rootScope","$log","leafletHelpers","leafletLayerHelpers","leafletMapDefaults",function(e,t,r,a,n){var o=r.isDefined,i=r.isObject,l=a.createLayer,s={},c=r.errorHeader+" [Controls] ",u=function(e,t,r){var a=n.getDefaults(r);if(!a.controls.layers.visible)return!1;var l=!1;return i(e)&&Object.keys(e).forEach(function(t){var r=e[t];o(r.layerOptions)&&r.layerOptions.showOnSelector===!1||(l=!0)}),i(t)&&Object.keys(t).forEach(function(e){var r=t[e];o(r.layerParams)&&r.layerParams.showOnSelector===!1||(l=!0)}),l},d=function(e){var t=n.getDefaults(e),r={collapsed:t.controls.layers.collapsed,position:t.controls.layers.position,autoZIndex:!1};angular.extend(r,t.controls.layers.options);var a;return a=t.controls.layers&&o(t.controls.layers.control)?t.controls.layers.control.apply(this,[[],[],r]):new L.control.layers([],[],r)},f={draw:{isPluginLoaded:function(){return!!angular.isDefined(L.Control.Draw)||(t.error(c+" Draw plugin is not loaded."),!1)},checkValidParams:function(){return!0},createControl:function(e){return new L.Control.Draw(e)}},scale:{isPluginLoaded:function(){return!0},checkValidParams:function(){return!0},createControl:function(e){return new L.control.scale(e)}},fullscreen:{isPluginLoaded:function(){return!!angular.isDefined(L.Control.Fullscreen)||(t.error(c+" Fullscreen plugin is not loaded."),!1)},checkValidParams:function(){return!0},createControl:function(e){return new L.Control.Fullscreen(e)}},search:{isPluginLoaded:function(){return!!angular.isDefined(L.Control.Search)||(t.error(c+" Search plugin is not loaded."),!1)},checkValidParams:function(){return!0},createControl:function(e){return new L.Control.Search(e)}},custom:{},minimap:{isPluginLoaded:function(){return!!angular.isDefined(L.Control.MiniMap)||(t.error(c+" Minimap plugin is not loaded."),!1)},checkValidParams:function(e){return!!o(e.layer)||(t.warn(c+' minimap "layer" option should be defined.'),!1)},createControl:function(e){var r=l(e.layer);return o(r)?new L.Control.MiniMap(r,e):void t.warn(c+' minimap control "layer" could not be created.')}}};return{layersControlMustBeVisible:u,isValidControlType:function(e){return-1!==Object.keys(f).indexOf(e)},createControl:function(e,t){return f[e].checkValidParams(t)?f[e].createControl(t):void 0},updateLayersControl:function(e,t,r,a,n,i){var l,c=s[t],f=u(a,n,t);if(o(c)&&r){for(l in i.baselayers)c.removeLayer(i.baselayers[l]);for(l in i.overlays)c.removeLayer(i.overlays[l]);e.removeControl(c),delete s[t]}if(f){c=d(t),s[t]=c;for(l in a){var p=o(a[l].layerOptions)&&a[l].layerOptions.showOnSelector===!1;!p&&o(i.baselayers[l])&&c.addBaseLayer(i.baselayers[l],a[l].name)}for(l in n){var g=o(n[l].layerParams)&&n[l].layerParams.showOnSelector===!1;!g&&o(i.overlays[l])&&c.addOverlay(i.overlays[l],n[l].name)}e.addControl(c)}return f}}}]),angular.module("leaflet-directive").service("leafletData",["$log","$q","leafletHelpers",function(e,t,r){var a=r.getDefer,n=r.getUnresolvedDefer,o=r.setResolvedDefer,i={},l=this,s=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},c=["map","tiles","layers","paths","markers","geoJSON","UTFGrid","decorations","directiveControls"];c.forEach(function(e){i[e]={}}),this.unresolveMap=function(e){var t=r.obtainEffectiveMapId(i.map,e);c.forEach(function(e){i[e][t]=void 0})},c.forEach(function(e){var t=s(e);l["set"+t]=function(t,r){var a=n(i[e],r);a.resolve(t),o(i[e],r)},l["get"+t]=function(t){var r=a(i[e],t);return r.promise}})}]),angular.module("leaflet-directive").service("leafletDirectiveControlsHelpers",["$log","leafletData","leafletHelpers",function(e,t,r){var a=r.isDefined,n=r.isString,o=r.isObject,i=r.errorHeader,l=i+"[leafletDirectiveControlsHelpers",s=function(r,i,s,c){var u=l+".extend] ",d={};if(!a(i))return void e.error(u+"thingToAddName cannot be undefined");if(n(i)&&a(s)&&a(c))d[i]={create:s,clean:c};else{if(!o(i)||a(s)||a(c))return void e.error(u+"incorrect arguments");d=i}t.getDirectiveControls().then(function(e){angular.extend(e,d),t.setDirectiveControls(e,r)})};return{extend:s}}]),angular.module("leaflet-directive").service("leafletGeoJsonHelpers",["leafletHelpers","leafletIterators",function(e,t){var r=e,a=t,n=function(e,t){return this.lat=e,this.lng=t,this},o=function(e){return Array.isArray(e)&&2===e.length?e[1]:r.isDefined(e.type)&&"Point"===e.type?+e.coordinates[1]:+e.lat},i=function(e){return Array.isArray(e)&&2===e.length?e[0]:r.isDefined(e.type)&&"Point"===e.type?+e.coordinates[0]:+e.lng},l=function(e){if(r.isUndefined(e))return!1;if(r.isArray(e)){if(2===e.length&&r.isNumber(e[0])&&r.isNumber(e[1]))return!0}else if(r.isDefined(e.type)&&"Point"===e.type&&r.isArray(e.coordinates)&&2===e.coordinates.length&&r.isNumber(e.coordinates[0])&&r.isNumber(e.coordinates[1]))return!0;var t=a.all(["lat","lng"],function(t){return r.isDefined(e[t])&&r.isNumber(e[t])});return t},s=function(e){if(e&&l(e)){var t=null;if(Array.isArray(e)&&2===e.length)t=new n(e[1],e[0]);else{if(!r.isDefined(e.type)||"Point"!==e.type)return e;t=new n(e.coordinates[1],e.coordinates[0])}return angular.extend(e,t)}};return{getLat:o,getLng:i,validateCoords:l,getCoords:s}}]),angular.module("leaflet-directive").service("leafletHelpers",["$q","$log",function(e,t){function r(e,r){var a,o;if(angular.isDefined(r))a=r;else if(0===Object.keys(e).length)a="main";else if(Object.keys(e).length>=1)for(o in e)e.hasOwnProperty(o)&&(a=o);else t.error(n+"- You have more than 1 map on the DOM, you must provide the map ID to the leafletData.getXXX call");return a}function a(t,a){var n,o=r(t,a);return angular.isDefined(t[o])&&t[o].resolvedDefer!==!0?n=t[o].defer:(n=e.defer(),t[o]={defer:n,resolvedDefer:!1}),n}var n="[AngularJS - Leaflet] ",o=angular.copy,i=o,l=function(e,t){var r;if(e&&angular.isObject(e))return null!==t&&angular.isString(t)?(r=e,t.split(".").forEach(function(e){r&&(r=r[e])}),r):t},s=function(e){return e.split(".").reduce(function(e,t){return e+'["'+t+'"]'})},c=function(e){return e.reduce(function(e,t){return e+"."+t})},u=function(e){return angular.isDefined(e)&&null!==e},d=function(e){return!u(e)},f=/([\:\-\_]+(.))/g,p=/^moz([A-Z])/,g=/^((?:x|data)[\:\-_])/i,v=function(e){return e.replace(f,function(e,t,r,a){return a?r.toUpperCase():r}).replace(p,"Moz$1")},y=function(e){return v(e.replace(g,""))};return{camelCase:v,directiveNormalize:y,copy:o,clone:i,errorHeader:n,getObjectValue:l,getObjectArrayPath:s,getObjectDotPath:c,defaultTo:function(e,t){return u(e)?e:t},isTruthy:function(e){return"true"===e||e===!0},isEmpty:function(e){return 0===Object.keys(e).length},isUndefinedOrEmpty:function(e){return angular.isUndefined(e)||null===e||0===Object.keys(e).length},isDefined:u,isUndefined:d,isNumber:angular.isNumber,isString:angular.isString,isArray:angular.isArray,isObject:angular.isObject,isFunction:angular.isFunction,equals:angular.equals,isValidCenter:function(e){return angular.isDefined(e)&&angular.isNumber(e.lat)&&angular.isNumber(e.lng)&&angular.isNumber(e.zoom)},isValidPoint:function(e){return!!angular.isDefined(e)&&(angular.isArray(e)?2===e.length&&angular.isNumber(e[0])&&angular.isNumber(e[1]):angular.isNumber(e.lat)&&angular.isNumber(e.lng))},isSameCenterOnMap:function(e,t){var r=t.getCenter(),a=t.getZoom();return!(!e.lat||!e.lng||r.lat.toFixed(4)!==e.lat.toFixed(4)||r.lng.toFixed(4)!==e.lng.toFixed(4)||a!==e.zoom)},safeApply:function(e,t){var r=e.$root.$$phase;"$apply"===r||"$digest"===r?e.$eval(t):e.$evalAsync(t)},obtainEffectiveMapId:r,getDefer:function(e,t){var n,o=r(e,t);return n=angular.isDefined(e[o])&&e[o].resolvedDefer!==!1?e[o].defer:a(e,t)},getUnresolvedDefer:a,setResolvedDefer:function(e,t){var a=r(e,t);e[a].resolvedDefer=!0},rangeIsSupported:function(){var e=document.createElement("input");return e.setAttribute("type","range"),"range"===e.type},FullScreenControlPlugin:{isLoaded:function(){return angular.isDefined(L.Control.Fullscreen)}},MiniMapControlPlugin:{isLoaded:function(){return angular.isDefined(L.Control.MiniMap)}},AwesomeMarkersPlugin:{isLoaded:function(){return angular.isDefined(L.AwesomeMarkers)&&angular.isDefined(L.AwesomeMarkers.Icon)},is:function(e){return!!this.isLoaded()&&e instanceof L.AwesomeMarkers.Icon},equal:function(e,t){return!(!this.isLoaded()||!this.is(e))&&angular.equals(e,t)}},VectorMarkersPlugin:{isLoaded:function(){return angular.isDefined(L.VectorMarkers)&&angular.isDefined(L.VectorMarkers.Icon)},is:function(e){return!!this.isLoaded()&&e instanceof L.VectorMarkers.Icon},equal:function(e,t){return!(!this.isLoaded()||!this.is(e))&&angular.equals(e,t)}},DomMarkersPlugin:{isLoaded:function(){return!(!angular.isDefined(L.DomMarkers)||!angular.isDefined(L.DomMarkers.Icon))},is:function(e){return!!this.isLoaded()&&e instanceof L.DomMarkers.Icon},equal:function(e,t){return!(!this.isLoaded()||!this.is(e))&&angular.equals(e,t)}},PolylineDecoratorPlugin:{isLoaded:function(){return!!angular.isDefined(L.PolylineDecorator)},is:function(e){return!!this.isLoaded()&&e instanceof L.PolylineDecorator},equal:function(e,t){return!(!this.isLoaded()||!this.is(e))&&angular.equals(e,t)}},MakiMarkersPlugin:{isLoaded:function(){return!(!angular.isDefined(L.MakiMarkers)||!angular.isDefined(L.MakiMarkers.Icon))},is:function(e){return!!this.isLoaded()&&e instanceof L.MakiMarkers.Icon},equal:function(e,t){return!(!this.isLoaded()||!this.is(e))&&angular.equals(e,t)}},ExtraMarkersPlugin:{isLoaded:function(){return!(!angular.isDefined(L.ExtraMarkers)||!angular.isDefined(L.ExtraMarkers.Icon))},is:function(e){return!!this.isLoaded()&&e instanceof L.ExtraMarkers.Icon},equal:function(e,t){return!(!this.isLoaded()||!this.is(e))&&angular.equals(e,t)}},LabelPlugin:{isLoaded:function(){return angular.isDefined(L.Label)},is:function(e){return!!this.isLoaded()&&e instanceof L.MarkerClusterGroup}},MarkerClusterPlugin:{isLoaded:function(){return angular.isDefined(L.MarkerClusterGroup)},is:function(e){return!!this.isLoaded()&&e instanceof L.MarkerClusterGroup}},GoogleLayerPlugin:{isLoaded:function(){return angular.isDefined(L.Google)},is:function(e){return!!this.isLoaded()&&e instanceof L.Google}},LeafletProviderPlugin:{isLoaded:function(){return angular.isDefined(L.TileLayer.Provider)},is:function(e){return!!this.isLoaded()&&e instanceof L.TileLayer.Provider}},ChinaLayerPlugin:{isLoaded:function(){return angular.isDefined(L.tileLayer.chinaProvider)}},HeatLayerPlugin:{isLoaded:function(){return angular.isDefined(L.heatLayer)}},WebGLHeatMapLayerPlugin:{isLoaded:function(){return angular.isDefined(L.TileLayer.WebGLHeatMap)}},BingLayerPlugin:{isLoaded:function(){return angular.isDefined(L.BingLayer)},is:function(e){return!!this.isLoaded()&&e instanceof L.BingLayer}},WFSLayerPlugin:{isLoaded:function(){return void 0!==L.GeoJSON.WFS},is:function(e){return!!this.isLoaded()&&e instanceof L.GeoJSON.WFS}},AGSBaseLayerPlugin:{isLoaded:function(){return void 0!==L.esri&&void 0!==L.esri.basemapLayer},is:function(e){return!!this.isLoaded()&&e instanceof L.esri.basemapLayer}},AGSLayerPlugin:{isLoaded:function(){return void 0!==lvector&&void 0!==lvector.AGS},is:function(e){return!!this.isLoaded()&&e instanceof lvector.AGS}},AGSFeatureLayerPlugin:{isLoaded:function(){return void 0!==L.esri&&void 0!==L.esri.featureLayer},is:function(e){return!!this.isLoaded()&&e instanceof L.esri.featureLayer}},AGSTiledMapLayerPlugin:{isLoaded:function(){return void 0!==L.esri&&void 0!==L.esri.tiledMapLayer},is:function(e){return!!this.isLoaded()&&e instanceof L.esri.tiledMapLayer}},AGSDynamicMapLayerPlugin:{isLoaded:function(){return void 0!==L.esri&&void 0!==L.esri.dynamicMapLayer},is:function(e){return!!this.isLoaded()&&e instanceof L.esri.dynamicMapLayer}},AGSImageMapLayerPlugin:{isLoaded:function(){return void 0!==L.esri&&void 0!==L.esri.imageMapLayer},is:function(e){return!!this.isLoaded()&&e instanceof L.esri.imageMapLayer}},AGSClusteredLayerPlugin:{isLoaded:function(){return void 0!==L.esri&&void 0!==L.esri.clusteredFeatureLayer},is:function(e){return!!this.isLoaded()&&e instanceof L.esri.clusteredFeatureLayer}},AGSHeatmapLayerPlugin:{isLoaded:function(){return void 0!==L.esri&&void 0!==L.esri.heatmapFeatureLayer},is:function(e){return!!this.isLoaded()&&e instanceof L.esri.heatmapFeatureLayer}},YandexLayerPlugin:{isLoaded:function(){return angular.isDefined(L.Yandex)},is:function(e){return!!this.isLoaded()&&e instanceof L.Yandex}},GeoJSONPlugin:{isLoaded:function(){return angular.isDefined(L.TileLayer.GeoJSON)},is:function(e){return!!this.isLoaded()&&e instanceof L.TileLayer.GeoJSON}},UTFGridPlugin:{isLoaded:function(){return angular.isDefined(L.UtfGrid)},is:function(e){return this.isLoaded()?e instanceof L.UtfGrid:(t.error("[AngularJS - Leaflet] No UtfGrid plugin found."),!1)}},CartoDB:{isLoaded:function(){return cartodb},is:function(){return!0}},Leaflet:{DivIcon:{is:function(e){return e instanceof L.DivIcon},equal:function(e,t){return!!this.is(e)&&angular.equals(e,t)}},Icon:{is:function(e){return e instanceof L.Icon},equal:function(e,t){return!!this.is(e)&&angular.equals(e,t)}}},watchOptions:{doWatch:!0,isDeep:!0,individual:{doWatch:!0,isDeep:!0}}}}]),angular.module("leaflet-directive").service("leafletIterators",["$log","leafletHelpers",function(e,t){var r,a=t,n=t.errorHeader+"leafletIterators: ",o=Object.keys,i=a.isFunction,l=a.isObject,s=Math.pow(2,53)-1,c=function(e){var t=null!==e&&e.length;return a.isNumber(t)&&t>=0&&s>=t},u=function(e){return e},d=function(e){return function(t){return null===t?void 0:t[e]}},f=function(e,t,r){if(void 0===t)return e;switch(null===r?3:r){case 1:return function(r){return e.call(t,r)};case 2:return function(r,a){return e.call(t,r,a)};case 3:return function(r,a,n){return e.call(t,r,a,n)};case 4:return function(r,a,n,o){return e.call(t,r,a,n,o)}}return function(){return e.apply(t,arguments)}},p=function(e,t){return function(r){var a=arguments.length;if(2>a||null===r)return r;for(var n=1;a>n;n++)for(var o=arguments[n],i=e(o),l=i.length,s=0;l>s;s++){var c=i[s];t&&void 0!==r[c]||(r[c]=o[c])}return r}},g=null;r=g=p(o);var v,y=function(e,t){var r=o(t),a=r.length;if(null===e)return!a;for(var n=Object(e),i=0;a>i;i++){var l=r[i];if(t[l]!==n[l]||!(l in n))return!1}return!0},h=null;v=h=function(e){return e=r({},e),function(t){return y(t,e)}};var m,L=function(e,t,r){return null===e?u:i(e)?f(e,t,r):l(e)?v(e):d(e)},b=null;m=b=function(e,t,r){t=L(t,r);for(var a=!c(e)&&o(e),n=(a||e).length,i=0;n>i;i++){var l=a?a[i]:i;if(!t(e[l],l,e))return!1}return!0};var C=function(t,r,o,i){return!(o||a.isDefined(t)&&a.isDefined(r))||!a.isFunction(r)&&(i=a.defaultTo(r,"cb"),e.error(n+i+" is not a function"),!0)},P=function(e,t,r){if(!C(void 0,r,!0,"internalCb")&&!C(e,t))for(var a in e)e.hasOwnProperty(a)&&r(e[a],a)},k=function(e,t){P(e,t,function(e,r){t(e,r)})};return{each:k,forEach:k,every:m,all:b}}]),angular.module("leaflet-directive").factory("leafletLayerHelpers",["$rootScope","$log","$q","leafletHelpers","leafletIterators",function($rootScope,$log,$q,leafletHelpers,leafletIterators){function isValidLayerType(e){return isString(e.type)?-1===Object.keys(layerTypes).indexOf(e.type)?($log.error("[AngularJS - Leaflet] A layer must have a valid type: "+Object.keys(layerTypes)),!1):layerTypes[e.type].mustHaveUrl&&!isString(e.url)?($log.error("[AngularJS - Leaflet] A base layer must have an url"),!1):layerTypes[e.type].mustHaveData&&!isDefined(e.data)?($log.error('[AngularJS - Leaflet] The base layer must have a "data" array attribute'),!1):layerTypes[e.type].mustHaveLayer&&!isDefined(e.layer)?($log.error("[AngularJS - Leaflet] The type of layer "+e.type+" must have an layer defined"),!1):layerTypes[e.type].mustHaveBounds&&!isDefined(e.bounds)?($log.error("[AngularJS - Leaflet] The type of layer "+e.type+" must have bounds defined"),!1):!(layerTypes[e.type].mustHaveKey&&!isDefined(e.key))||($log.error("[AngularJS - Leaflet] The type of layer "+e.type+" must have key defined"),!1):($log.error("[AngularJS - Leaflet] A layer must have a valid type defined."),!1)}function createLayer(e){if(isValidLayerType(e)){if(!isString(e.name))return void $log.error("[AngularJS - Leaflet] A base layer must have a name");isObject(e.layerParams)||(e.layerParams={}),isObject(e.layerOptions)||(e.layerOptions={});for(var t in e.layerParams)e.layerOptions[t]=e.layerParams[t];var r={url:e.url,data:e.data,options:e.layerOptions,layer:e.layer,icon:e.icon,type:e.layerType,bounds:e.bounds,key:e.key,apiKey:e.apiKey,pluginOptions:e.pluginOptions,user:e.user};return layerTypes[e.type].createLayer(r)}}function safeAddLayer(e,t){t&&"function"==typeof t.addTo?t.addTo(e):e.addLayer(t)}function safeRemoveLayer(e,t,r){if(isDefined(r)&&isDefined(r.loadedDefer))if(angular.isFunction(r.loadedDefer)){var a=r.loadedDefer();$log.debug("Loaded Deferred",a);var n=a.length;if(n>0)for(var o=function(){n--,0===n&&e.removeLayer(t)},i=0;i<a.length;i++)a[i].promise.then(o);else e.removeLayer(t)}else r.loadedDefer.promise.then(function(){e.removeLayer(t)});else e.removeLayer(t)}var Helpers=leafletHelpers,isString=leafletHelpers.isString,isObject=leafletHelpers.isObject,isArray=leafletHelpers.isArray,isDefined=leafletHelpers.isDefined,errorHeader=leafletHelpers.errorHeader,$it=leafletIterators,utfGridCreateLayer=function(e){if(!Helpers.UTFGridPlugin.isLoaded())return void $log.error("[AngularJS - Leaflet] The UTFGrid plugin is not loaded.");var t=new L.UtfGrid(e.url,e.pluginOptions);return t.on("mouseover",function(e){$rootScope.$broadcast("leafletDirectiveMap.utfgridMouseover",e)}),t.on("mouseout",function(e){$rootScope.$broadcast("leafletDirectiveMap.utfgridMouseout",e)}),t.on("click",function(e){$rootScope.$broadcast("leafletDirectiveMap.utfgridClick",e)}),t.on("mousemove",function(e){$rootScope.$broadcast("leafletDirectiveMap.utfgridMousemove",e)}),t},layerTypes={xyz:{mustHaveUrl:!0,createLayer:function(e){return L.tileLayer(e.url,e.options)}},mapbox:{mustHaveKey:!0,createLayer:function(e){var t=3;isDefined(e.options.version)&&4===e.options.version&&(t=e.options.version);var r=3===t?"//{s}.tiles.mapbox.com/v3/"+e.key+"/{z}/{x}/{y}.png":"//api.tiles.mapbox.com/v4/"+e.key+"/{z}/{x}/{y}.png?access_token="+e.apiKey;return L.tileLayer(r,e.options)}},geoJSON:{mustHaveUrl:!0,createLayer:function(e){return Helpers.GeoJSONPlugin.isLoaded()?new L.TileLayer.GeoJSON(e.url,e.pluginOptions,e.options):void 0}},geoJSONShape:{mustHaveUrl:!1,createLayer:function(e){return new L.GeoJSON(e.data,e.options)}},geoJSONAwesomeMarker:{mustHaveUrl:!1,createLayer:function(e){return new L.geoJson(e.data,{pointToLayer:function(t,r){return L.marker(r,{icon:L.AwesomeMarkers.icon(e.icon)})}})}},geoJSONVectorMarker:{mustHaveUrl:!1,createLayer:function(e){return new L.geoJson(e.data,{pointToLayer:function(t,r){return L.marker(r,{icon:L.VectorMarkers.icon(e.icon)})}})}},utfGrid:{mustHaveUrl:!0,createLayer:utfGridCreateLayer},cartodbTiles:{mustHaveKey:!0,createLayer:function(e){var t="//"+e.user+".cartodb.com/api/v1/map/"+e.key+"/{z}/{x}/{y}.png";return L.tileLayer(t,e.options)}},cartodbUTFGrid:{mustHaveKey:!0,mustHaveLayer:!0,createLayer:function(e){return e.url="//"+e.user+".cartodb.com/api/v1/map/"+e.key+"/"+e.layer+"/{z}/{x}/{y}.grid.json",utfGridCreateLayer(e)}},cartodbInteractive:{mustHaveKey:!0,mustHaveLayer:!0,createLayer:function(e){var t="//"+e.user+".cartodb.com/api/v1/map/"+e.key+"/{z}/{x}/{y}.png",r=L.tileLayer(t,e.options);e.url="//"+e.user+".cartodb.com/api/v1/map/"+e.key+"/"+e.layer+"/{z}/{x}/{y}.grid.json";var a=utfGridCreateLayer(e);return L.layerGroup([r,a])}},wms:{mustHaveUrl:!0,createLayer:function(e){return L.tileLayer.wms(e.url,e.options)}},wmts:{mustHaveUrl:!0,createLayer:function(e){return L.tileLayer.wmts(e.url,e.options)}},wfs:{mustHaveUrl:!0,mustHaveLayer:!0,createLayer:function(params){if(Helpers.WFSLayerPlugin.isLoaded()){var options=angular.copy(params.options);return options.crs&&"string"==typeof options.crs&&(options.crs=eval(options.crs)),new L.GeoJSON.WFS(params.url,params.layer,options)}}},group:{mustHaveUrl:!1,createLayer:function(e){var t=[];return $it.each(e.options.layers,function(e){t.push(createLayer(e))}),e.options.loadedDefer=function(){var t=[];if(isDefined(e.options.layers))for(var r=0;r<e.options.layers.length;r++){var a=e.options.layers[r].layerOptions.loadedDefer;isDefined(a)&&t.push(a)}return t},L.layerGroup(t)}},featureGroup:{mustHaveUrl:!1,createLayer:function(){return L.featureGroup()}},google:{mustHaveUrl:!1,createLayer:function(e){var t=e.type||"SATELLITE";if(Helpers.GoogleLayerPlugin.isLoaded())return new L.Google(t,e.options)}},here:{mustHaveUrl:!1,createLayer:function(e){var t=e.provider||"HERE.terrainDay";if(Helpers.LeafletProviderPlugin.isLoaded())return new L.TileLayer.Provider(t,e.options)}},china:{mustHaveUrl:!1,createLayer:function(e){var t=e.type||"";if(Helpers.ChinaLayerPlugin.isLoaded())return L.tileLayer.chinaProvider(t,e.options)}},agsBase:{mustHaveLayer:!0,createLayer:function(e){return Helpers.AGSBaseLayerPlugin.isLoaded()?L.esri.basemapLayer(e.layer,e.options):void 0;
}},ags:{mustHaveUrl:!0,createLayer:function(e){if(Helpers.AGSLayerPlugin.isLoaded()){var t=angular.copy(e.options);angular.extend(t,{url:e.url});var r=new lvector.AGS(t);return r.onAdd=function(e){this.setMap(e)},r.onRemove=function(){this.setMap(null)},r}}},agsFeature:{mustHaveUrl:!0,createLayer:function(e){if(!Helpers.AGSFeatureLayerPlugin.isLoaded())return void $log.warn(errorHeader+" The esri plugin is not loaded.");e.options.url=e.url;var t=L.esri.featureLayer(e.options),r=function(){isDefined(e.options.loadedDefer)&&e.options.loadedDefer.resolve()};return t.on("loading",function(){e.options.loadedDefer=$q.defer(),t.off("load",r),t.on("load",r)}),t}},agsTiled:{mustHaveUrl:!0,createLayer:function(e){return Helpers.AGSTiledMapLayerPlugin.isLoaded()?(e.options.url=e.url,L.esri.tiledMapLayer(e.options)):void $log.warn(errorHeader+" The esri plugin is not loaded.")}},agsDynamic:{mustHaveUrl:!0,createLayer:function(e){return Helpers.AGSDynamicMapLayerPlugin.isLoaded()?(e.options.url=e.url,L.esri.dynamicMapLayer(e.options)):void $log.warn(errorHeader+" The esri plugin is not loaded.")}},agsImage:{mustHaveUrl:!0,createLayer:function(e){return Helpers.AGSImageMapLayerPlugin.isLoaded()?(e.options.url=e.url,L.esri.imageMapLayer(e.options)):void $log.warn(errorHeader+" The esri plugin is not loaded.")}},agsClustered:{mustHaveUrl:!0,createLayer:function(e){return Helpers.AGSClusteredLayerPlugin.isLoaded()?Helpers.MarkerClusterPlugin.isLoaded()?L.esri.clusteredFeatureLayer(e.url,e.options):void $log.warn(errorHeader+" The markercluster plugin is not loaded."):void $log.warn(errorHeader+" The esri clustered layer plugin is not loaded.")}},agsHeatmap:{mustHaveUrl:!0,createLayer:function(e){return Helpers.AGSHeatmapLayerPlugin.isLoaded()?Helpers.HeatLayerPlugin.isLoaded()?L.esri.heatmapFeatureLayer(e.url,e.options):void $log.warn(errorHeader+" The heatlayer plugin is not loaded."):void $log.warn(errorHeader+" The esri heatmap layer plugin is not loaded.")}},markercluster:{mustHaveUrl:!1,createLayer:function(e){return Helpers.MarkerClusterPlugin.isLoaded()?new L.MarkerClusterGroup(e.options):void $log.warn(errorHeader+" The markercluster plugin is not loaded.")}},bing:{mustHaveUrl:!1,createLayer:function(e){return Helpers.BingLayerPlugin.isLoaded()?new L.BingLayer(e.key,e.options):void 0}},webGLHeatmap:{mustHaveUrl:!1,mustHaveData:!0,createLayer:function(e){if(Helpers.WebGLHeatMapLayerPlugin.isLoaded()){var t=new L.TileLayer.WebGLHeatMap(e.options);return isDefined(e.data)&&t.setData(e.data),t}}},heat:{mustHaveUrl:!1,mustHaveData:!0,createLayer:function(e){if(Helpers.HeatLayerPlugin.isLoaded()){var t=new L.heatLayer;return isArray(e.data)&&t.setLatLngs(e.data),isObject(e.options)&&t.setOptions(e.options),t}}},yandex:{mustHaveUrl:!1,createLayer:function(e){var t=e.type||"map";if(Helpers.YandexLayerPlugin.isLoaded())return new L.Yandex(t,e.options)}},imageOverlay:{mustHaveUrl:!0,mustHaveBounds:!0,createLayer:function(e){return L.imageOverlay(e.url,e.bounds,e.options)}},iip:{mustHaveUrl:!0,createLayer:function(e){return L.tileLayer.iip(e.url,e.options)}},custom:{createLayer:function(e){return e.layer instanceof L.Class?angular.copy(e.layer):void $log.error("[AngularJS - Leaflet] A custom layer must be a leaflet Class")}},cartodb:{mustHaveUrl:!0,createLayer:function(e){return cartodb.createLayer(e.map,e.url)}}};return{createLayer:createLayer,safeAddLayer:safeAddLayer,safeRemoveLayer:safeRemoveLayer}}]),angular.module("leaflet-directive").factory("leafletLegendHelpers",function(){var e=function(e,t,r,a){if(e.innerHTML="",t.error)e.innerHTML+='<div class="info-title alert alert-danger">'+t.error.message+"</div>";else if("arcgis"===r)for(var n=0;n<t.layers.length;n++){var o=t.layers[n];e.innerHTML+='<div class="info-title" data-layerid="'+o.layerId+'">'+o.layerName+"</div>";for(var i=0;i<o.legend.length;i++){var l=o.legend[i];e.innerHTML+='<div class="inline" data-layerid="'+o.layerId+'"><img src="data:'+l.contentType+";base64,"+l.imageData+'" /></div><div class="info-label" data-layerid="'+o.layerId+'">'+l.label+"</div>"}}else"image"===r&&(e.innerHTML='<img src="'+a+'"/>')},t=function(t,r,a,n){return function(){var o=L.DomUtil.create("div",r);return L.Browser.touch?L.DomEvent.on(o,"click",L.DomEvent.stopPropagation):(L.DomEvent.disableClickPropagation(o),L.DomEvent.on(o,"mousewheel",L.DomEvent.stopPropagation)),e(o,t,a,n),o}},r=function(e,t){return function(){for(var r=L.DomUtil.create("div",t),a=0;a<e.colors.length;a++)r.innerHTML+='<div class="outline"><i style="background:'+e.colors[a]+'"></i></div><div class="info-label">'+e.labels[a]+"</div>";return L.Browser.touch?L.DomEvent.on(r,"click",L.DomEvent.stopPropagation):(L.DomEvent.disableClickPropagation(r),L.DomEvent.on(r,"mousewheel",L.DomEvent.stopPropagation)),r}};return{getOnAddLegend:t,getOnAddArrayLegend:r,updateLegend:e}}),angular.module("leaflet-directive").factory("leafletMapDefaults",["$q","leafletHelpers",function(e,t){function r(){return{keyboard:!0,dragging:!0,worldCopyJump:!1,doubleClickZoom:!0,scrollWheelZoom:!0,tap:!0,touchZoom:!0,zoomControl:!0,zoomsliderControl:!1,zoomControlPosition:"topleft",attributionControl:!0,controls:{layers:{visible:!0,position:"topright",collapsed:!0}},nominatim:{server:" http://nominatim.openstreetmap.org/search"},crs:L.CRS.EPSG3857,tileLayer:"//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",tileLayerOptions:{attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'},path:{weight:10,opacity:1,color:"#0000ff"},center:{lat:0,lng:0,zoom:1}}}var a=t.isDefined,n=t.isObject,o=t.obtainEffectiveMapId,i={};return{reset:function(){i={}},getDefaults:function(e){var t=o(i,e);return i[t]},getMapCreationDefaults:function(e){var t=o(i,e),r=i[t],n={maxZoom:r.maxZoom,keyboard:r.keyboard,dragging:r.dragging,zoomControl:r.zoomControl,doubleClickZoom:r.doubleClickZoom,scrollWheelZoom:r.scrollWheelZoom,tap:r.tap,touchZoom:r.touchZoom,attributionControl:r.attributionControl,worldCopyJump:r.worldCopyJump,crs:r.crs};if(a(r.minZoom)&&(n.minZoom=r.minZoom),a(r.zoomAnimation)&&(n.zoomAnimation=r.zoomAnimation),a(r.fadeAnimation)&&(n.fadeAnimation=r.fadeAnimation),a(r.markerZoomAnimation)&&(n.markerZoomAnimation=r.markerZoomAnimation),r.map)for(var l in r.map)n[l]=r.map[l];return n},setDefaults:function(e,t){var l=r();a(e)&&(l.doubleClickZoom=a(e.doubleClickZoom)?e.doubleClickZoom:l.doubleClickZoom,l.scrollWheelZoom=a(e.scrollWheelZoom)?e.scrollWheelZoom:l.doubleClickZoom,l.tap=a(e.tap)?e.tap:l.tap,l.touchZoom=a(e.touchZoom)?e.touchZoom:l.doubleClickZoom,l.zoomControl=a(e.zoomControl)?e.zoomControl:l.zoomControl,l.zoomsliderControl=a(e.zoomsliderControl)?e.zoomsliderControl:l.zoomsliderControl,l.attributionControl=a(e.attributionControl)?e.attributionControl:l.attributionControl,l.tileLayer=a(e.tileLayer)?e.tileLayer:l.tileLayer,l.zoomControlPosition=a(e.zoomControlPosition)?e.zoomControlPosition:l.zoomControlPosition,l.keyboard=a(e.keyboard)?e.keyboard:l.keyboard,l.dragging=a(e.dragging)?e.dragging:l.dragging,a(e.controls)&&angular.extend(l.controls,e.controls),n(e.crs)?l.crs=e.crs:a(L.CRS[e.crs])&&(l.crs=L.CRS[e.crs]),a(e.center)&&angular.copy(e.center,l.center),a(e.tileLayerOptions)&&angular.copy(e.tileLayerOptions,l.tileLayerOptions),a(e.maxZoom)&&(l.maxZoom=e.maxZoom),a(e.minZoom)&&(l.minZoom=e.minZoom),a(e.zoomAnimation)&&(l.zoomAnimation=e.zoomAnimation),a(e.fadeAnimation)&&(l.fadeAnimation=e.fadeAnimation),a(e.markerZoomAnimation)&&(l.markerZoomAnimation=e.markerZoomAnimation),a(e.worldCopyJump)&&(l.worldCopyJump=e.worldCopyJump),a(e.map)&&(l.map=e.map),a(e.path)&&(l.path=e.path));var s=o(i,t);return i[s]=l,l}}}]),angular.module("leaflet-directive").service("leafletMarkersHelpers",["$rootScope","$timeout","leafletHelpers","$log","$compile","leafletGeoJsonHelpers",function(e,t,r,a,n,o){var i=r.isDefined,l=r.defaultTo,s=r.MarkerClusterPlugin,c=r.AwesomeMarkersPlugin,u=r.VectorMarkersPlugin,d=r.MakiMarkersPlugin,f=r.ExtraMarkersPlugin,p=r.DomMarkersPlugin,g=r.safeApply,v=r,y=r.isString,h=r.isNumber,m=r.isObject,b={},C=o,P=r.errorHeader,k=function(e){var t="";return["_icon","_latlng","_leaflet_id","_map","_shadow"].forEach(function(r){t+=r+": "+l(e[r],"undefined")+" \n"}),"[leafletMarker] : \n"+t},w=function(e,t){var r=t?console:a;r.debug(k(e))},D=function(t){if(i(t)&&i(t.type)&&"awesomeMarker"===t.type)return c.isLoaded()||a.error(P+" The AwesomeMarkers Plugin is not loaded."),new L.AwesomeMarkers.icon(t);if(i(t)&&i(t.type)&&"vectorMarker"===t.type)return u.isLoaded()||a.error(P+" The VectorMarkers Plugin is not loaded."),new L.VectorMarkers.icon(t);if(i(t)&&i(t.type)&&"makiMarker"===t.type)return d.isLoaded()||a.error(P+"The MakiMarkers Plugin is not loaded."),new L.MakiMarkers.icon(t);if(i(t)&&i(t.type)&&"extraMarker"===t.type)return f.isLoaded()||a.error(P+"The ExtraMarkers Plugin is not loaded."),new L.ExtraMarkers.icon(t);if(i(t)&&i(t.type)&&"div"===t.type)return new L.divIcon(t);if(i(t)&&i(t.type)&&"dom"===t.type){p.isLoaded()||a.error(P+"The DomMarkers Plugin is not loaded.");var r=angular.isFunction(t.getMarkerScope)?t.getMarkerScope():e,o=n(t.template)(r),l=angular.copy(t);return l.element=o[0],new L.DomMarkers.icon(l)}if(i(t)&&i(t.type)&&"icon"===t.type)return t.icon;var s="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAApCAYAAADAk4LOAAAGmklEQVRYw7VXeUyTZxjvNnfELFuyIzOabermMZEeQC/OclkO49CpOHXOLJl/CAURuYbQi3KLgEhbrhZ1aDwmaoGqKII6odATmH/scDFbdC7LvFqOCc+e95s2VG50X/LLm/f4/Z7neY/ne18aANCmAr5E/xZf1uDOkTcGcWR6hl9247tT5U7Y6SNvWsKT63P58qbfeLJG8M5qcgTknrvvrdDbsT7Ml+tv82X6vVxJE33aRmgSyYtcWVMqX97Yv2JvW39UhRE2HuyBL+t+gK1116ly06EeWFNlAmHxlQE0OMiV6mQCScusKRlhS3QLeVJdl1+23h5dY4FNB3thrbYboqptEFlphTC1hSpJnbRvxP4NWgsE5Jyz86QNNi/5qSUTGuFk1gu54tN9wuK2wc3o+Wc13RCmsoBwEqzGcZsxsvCSy/9wJKf7UWf1mEY8JWfewc67UUoDbDjQC+FqK4QqLVMGGR9d2wurKzqBk3nqIT/9zLxRRjgZ9bqQgub+DdoeCC03Q8j+0QhFhBHR/eP3U/zCln7Uu+hihJ1+bBNffLIvmkyP0gpBZWYXhKussK6mBz5HT6M1Nqpcp+mBCPXosYQfrekGvrjewd59/GvKCE7TbK/04/ZV5QZYVWmDwH1mF3xa2Q3ra3DBC5vBT1oP7PTj4C0+CcL8c7C2CtejqhuCnuIQHaKHzvcRfZpnylFfXsYJx3pNLwhKzRAwAhEqG0SpusBHfAKkxw3w4627MPhoCH798z7s0ZnBJ/MEJbZSbXPhER2ih7p2ok/zSj2cEJDd4CAe+5WYnBCgR2uruyEw6zRoW6/DWJ/OeAP8pd/BGtzOZKpG8oke0SX6GMmRk6GFlyAc59K32OTEinILRJRchah8HQwND8N435Z9Z0FY1EqtxUg+0SO6RJ/mmXz4VuS+DpxXC3gXmZwIL7dBSH4zKE50wESf8qwVgrP1EIlTO5JP9Igu0aexdh28F1lmAEGJGfh7jE6ElyM5Rw/FDcYJjWhbeiBYoYNIpc2FT/SILivp0F1ipDWk4BIEo2VuodEJUifhbiltnNBIXPUFCMpthtAyqws/BPlEF/VbaIxErdxPphsU7rcCp8DohC+GvBIPJS/tW2jtvTmmAeuNO8BNOYQeG8G/2OzCJ3q+soYB5i6NhMaKr17FSal7GIHheuV3uSCY8qYVuEm1cOzqdWr7ku/R0BDoTT+DT+ohCM6/CCvKLKO4RI+dXPeAuaMqksaKrZ7L3FE5FIFbkIceeOZ2OcHO6wIhTkNo0ffgjRGxEqogXHYUPHfWAC/lADpwGcLRY3aeK4/oRGCKYcZXPVoeX/kelVYY8dUGf8V5EBRbgJXT5QIPhP9ePJi428JKOiEYhYXFBqou2Guh+p/mEB1/RfMw6rY7cxcjTrneI1FrDyuzUSRm9miwEJx8E/gUmqlyvHGkneiwErR21F3tNOK5Tf0yXaT+O7DgCvALTUBXdM4YhC/IawPU+2PduqMvuaR6eoxSwUk75ggqsYJ7VicsnwGIkZBSXKOUww73WGXyqP+J2/b9c+gi1YAg/xpwck3gJuucNrh5JvDPvQr0WFXf0piyt8f8/WI0hV4pRxxkQZdJDfDJNOAmM0Ag8jyT6hz0WGXWuP94Yh2jcfjmXAGvHCMslRimDHYuHuDsy2QtHuIavznhbYURq5R57KpzBBRZKPJi8eQg48h4j8SDdowifdIrEVdU+gbO6QNvRRt4ZBthUaZhUnjlYObNagV3keoeru3rU7rcuceqU1mJBxy+BWZYlNEBH+0eH4vRiB+OYybU2hnblYlTvkHinM4m54YnxSyaZYSF6R3jwgP7udKLGIX6r/lbNa9N6y5MFynjWDtrHd75ZvTYAPO/6RgF0k76mQla3FGq7dO+cH8sKn0Vo7nDllwAhqwLPkxrHwWmHJOo+AKJ4rab5OgrM7rVu8eWb2Pu0Dh4eDgXoOfvp7Y7QeqknRmvcTBEyq9m/HQQSCSz6LHq3z0yzsNySRfMS253wl2KyRDbcZPcfJKjZmSEOjcxyi+Y8dUOtsIEH6R2wNykdqrkYJ0RV92H0W58pkfQk7cKevsLK10Py8SdMGfXNXATY+pPbyJR/ET6n9nIfztNtZYRV9XniQu9IA2vOVgy4ir7GCLVmmd+zjkH0eAF9Po6K61pmCXHxU5rHMYd1ftc3owjwRSVRzLjKvqZEty6cRUD7jGqiOdu5HG6MdHjNcNYGqfDm5YRzLBBCCDl/2bk8a8gdbqcfwECu62Fg/HrggAAAABJRU5ErkJggg==",g="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAApCAYAAACoYAD2AAAC5ElEQVRYw+2YW4/TMBCF45S0S1luXZCABy5CgLQgwf//S4BYBLTdJLax0fFqmB07nnQfEGqkIydpVH85M+NLjPe++dcPc4Q8Qh4hj5D/AaQJx6H/4TMwB0PeBNwU7EGQAmAtsNfAzoZkgIa0ZgLMa4Aj6CxIAsjhjOCoL5z7Glg1JAOkaicgvQBXuncwJAWjksLtBTWZe04CnYRktUGdilALppZBOgHGZcBzL6OClABvMSVIzyBjazOgrvACf1ydC5mguqAVg6RhdkSWQFj2uxfaq/BrIZOLEWgZdALIDvcMcZLD8ZbLC9de4yR1sYMi4G20S4Q/PWeJYxTOZn5zJXANZHIxAd4JWhPIloTJZhzMQduM89WQ3MUVAE/RnhAXpTycqys3NZALOBbB7kFrgLesQl2h45Fcj8L1tTSohUwuxhy8H/Qg6K7gIs+3kkaigQCOcyEXCHN07wyQazhrmIulvKMQAwMcmLNqyCVyMAI+BuxSMeTk3OPikLY2J1uE+VHQk6ANrhds+tNARqBeaGc72cK550FP4WhXmFmcMGhTwAR1ifOe3EvPqIegFmF+C8gVy0OfAaWQPMR7gF1OQKqGoBjq90HPMP01BUjPOqGFksC4emE48tWQAH0YmvOgF3DST6xieJgHAWxPAHMuNhrImIdvoNOKNWIOcE+UXE0pYAnkX6uhWsgVXDxHdTfCmrEEmMB2zMFimLVOtiiajxiGWrbU52EeCdyOwPEQD8LqyPH9Ti2kgYMf4OhSKB7qYILbBv3CuVTJ11Y80oaseiMWOONc/Y7kJYe0xL2f0BaiFTxknHO5HaMGMublKwxFGzYdWsBF174H/QDknhTHmHHN39iWFnkZx8lPyM8WHfYELmlLKtgWNmFNzQcC1b47gJ4hL19i7o65dhH0Negbca8vONZoP7doIeOC9zXm8RjuL0Gf4d4OYaU5ljo3GYiqzrWQHfJxA6ALhDpVKv9qYeZA8eM3EhfPSCmpuD0AAAAASUVORK5CYII=";return i(t)&&i(t.iconUrl)?new L.Icon(t):new L.Icon.Default({iconUrl:s,shadowUrl:g,iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]})},A=function(e){i(b[e])&&b.splice(e,1)},S=function(){b={}},O=function(e,t,r){if(e.closePopup(),i(r)&&i(r.overlays))for(var a in r.overlays)if((r.overlays[a]instanceof L.LayerGroup||r.overlays[a]instanceof L.FeatureGroup)&&r.overlays[a].hasLayer(e))return void r.overlays[a].removeLayer(e);if(i(b))for(var n in b)b[n].hasLayer(e)&&b[n].removeLayer(e);t.hasLayer(e)&&t.removeLayer(e)},M=function(e,t){var r=e._popup._container.offsetHeight,a=new L.Point(e._popup._containerLeft,-r-e._popup._containerBottom),n=t.layerPointToContainerPoint(a);null!==n&&e._popup._adjustPan()},H=function(e,t){n(e._popup._contentNode)(t)},$=function(e,r,a){var n=e._popup._contentNode.innerText||e._popup._contentNode.textContent;n.length<1&&t(function(){$(e,r,a)});var o=e._popup._contentNode.offsetWidth;return e._popup._updateLayout(),e._popup._updatePosition(),e._popup.options.autoPan&&M(e,a),o},E=function(t,r,n){var o=angular.isFunction(r.getMessageScope)?r.getMessageScope():e,l=!i(r.compileMessage)||r.compileMessage;if(l){if(!i(t._popup)||!i(t._popup._contentNode))return a.error(P+"Popup is invalid or does not have any content."),!1;H(t,o),$(t,r,n)}},T=function(t,r){var a=angular.isFunction(r.getMessageScope)?r.getMessageScope():e,o=angular.isFunction(r.getLabelScope)?r.getLabelScope():a,l=!i(r.compileMessage)||r.compileMessage;v.LabelPlugin.isLoaded()&&i(r.label)&&(i(r.label.options)&&r.label.options.noHide===!0&&t.showLabel(),l&&i(t.label)&&n(t.label._container)(o))},B=function(e,t,r,n,o,l,s){if(i(t)){if(!C.validateCoords(e))return a.warn("There are problems with lat-lng data, please verify your marker model"),void O(r,s,l);var c=e===t;if(i(e.iconAngle)&&t.iconAngle!==e.iconAngle&&r.setIconAngle(e.iconAngle),y(e.layer)||y(t.layer)&&(i(l.overlays[t.layer])&&l.overlays[t.layer].hasLayer(r)&&(l.overlays[t.layer].removeLayer(r),r.closePopup()),s.hasLayer(r)||s.addLayer(r)),(h(e.opacity)||h(parseFloat(e.opacity)))&&e.opacity!==t.opacity&&r.setOpacity(e.opacity),y(e.layer)&&t.layer!==e.layer){if(y(t.layer)&&i(l.overlays[t.layer])&&l.overlays[t.layer].hasLayer(r)&&l.overlays[t.layer].removeLayer(r),r.closePopup(),s.hasLayer(r)&&s.removeLayer(r),!i(l.overlays[e.layer]))return void a.error(P+"You must use a name of an existing layer");var u=l.overlays[e.layer];if(!(u instanceof L.LayerGroup||u instanceof L.FeatureGroup))return void a.error(P+'A marker can only be added to a layer of type "group" or "featureGroup"');u.addLayer(r),s.hasLayer(r)&&e.focus===!0&&r.openPopup()}if(e.draggable!==!0&&t.draggable===!0&&i(r.dragging)&&r.dragging.disable(),e.draggable===!0&&t.draggable!==!0&&(r.dragging?r.dragging.enable():L.Handler.MarkerDrag&&(r.dragging=new L.Handler.MarkerDrag(r),r.options.draggable=!0,r.dragging.enable())),m(e.icon)||m(t.icon)&&(r.setIcon(D()),r.closePopup(),r.unbindPopup(),y(e.message)&&r.bindPopup(e.message,e.popupOptions)),m(e.icon)&&m(t.icon)&&!angular.equals(e.icon,t.icon)){var d=!1;r.dragging&&(d=r.dragging.enabled()),r.setIcon(D(e.icon)),d&&r.dragging.enable(),r.closePopup(),r.unbindPopup(),y(e.message)&&(r.bindPopup(e.message,e.popupOptions),s.hasLayer(r)&&e.focus===!0&&r.openPopup())}!y(e.message)&&y(t.message)&&(r.closePopup(),r.unbindPopup()),v.LabelPlugin.isLoaded()&&(i(e.label)&&i(e.label.message)?"label"in t&&"message"in t.label&&!angular.equals(e.label.message,t.label.message)?r.updateLabelContent(e.label.message):!angular.isFunction(r.getLabel)||angular.isFunction(r.getLabel)&&!i(r.getLabel())?(r.bindLabel(e.label.message,e.label.options),T(r,e)):T(r,e):(!("label"in e)||"message"in e.label)&&angular.isFunction(r.unbindLabel)&&r.unbindLabel()),y(e.message)&&!y(t.message)&&r.bindPopup(e.message,e.popupOptions),y(e.message)&&y(t.message)&&e.message!==t.message&&r.setPopupContent(e.message);var f=!1;e.focus!==!0&&t.focus===!0&&(r.closePopup(),f=!0),(e.focus===!0&&(!i(t.focus)||t.focus===!1)||c&&e.focus===!0)&&(r.openPopup(),f=!0),t.zIndexOffset!==e.zIndexOffset&&r.setZIndexOffset(e.zIndexOffset);var p=r.getLatLng(),g=y(e.layer)&&v.MarkerClusterPlugin.is(l.overlays[e.layer]);g?f?(e.lat!==t.lat||e.lng!==t.lng)&&(l.overlays[e.layer].removeLayer(r),r.setLatLng([e.lat,e.lng]),l.overlays[e.layer].addLayer(r)):p.lat!==e.lat||p.lng!==e.lng?(l.overlays[e.layer].removeLayer(r),r.setLatLng([e.lat,e.lng]),l.overlays[e.layer].addLayer(r)):e.lat!==t.lat||e.lng!==t.lng?(l.overlays[e.layer].removeLayer(r),r.setLatLng([e.lat,e.lng]),l.overlays[e.layer].addLayer(r)):m(e.icon)&&m(t.icon)&&!angular.equals(e.icon,t.icon)&&(l.overlays[e.layer].removeLayer(r),l.overlays[e.layer].addLayer(r)):(p.lat!==e.lat||p.lng!==e.lng)&&r.setLatLng([e.lat,e.lng])}};return{resetMarkerGroup:A,resetMarkerGroups:S,deleteMarker:O,manageOpenPopup:E,manageOpenLabel:T,createMarker:function(e){if(!i(e)||!C.validateCoords(e))return void a.error(P+"The marker definition is not valid.");var t=C.getCoords(e);if(!i(t))return void a.error(P+"Unable to get coordinates from markerData.");var r={icon:D(e.icon),title:i(e.title)?e.title:"",draggable:!!i(e.draggable)&&e.draggable,clickable:!i(e.clickable)||e.clickable,riseOnHover:!!i(e.riseOnHover)&&e.riseOnHover,zIndexOffset:i(e.zIndexOffset)?e.zIndexOffset:0,iconAngle:i(e.iconAngle)?e.iconAngle:0};for(var n in e)e.hasOwnProperty(n)&&!r.hasOwnProperty(n)&&(r[n]=e[n]);var o=new L.marker(t,r);return y(e.message)||o.unbindPopup(),o},addMarkerToGroup:function(e,t,r,n){return y(t)?s.isLoaded()?(i(b[t])||(b[t]=new L.MarkerClusterGroup(r),n.addLayer(b[t])),void b[t].addLayer(e)):void a.error(P+"The MarkerCluster plugin is not loaded."):void a.error(P+"The marker group you have specified is invalid.")},listenMarkerEvents:function(e,t,r,a,n){e.on("popupopen",function(){g(r,function(){(i(e._popup)||i(e._popup._contentNode))&&(t.focus=!0,E(e,t,n))})}),e.on("popupclose",function(){g(r,function(){t.focus=!1})}),e.on("add",function(){g(r,function(){"label"in t&&T(e,t)})})},updateMarker:B,addMarkerWatcher:function(e,t,r,a,n,o){var s=v.getObjectArrayPath("markers."+t);o=l(o,!0);var c=r.$watch(s,function(o,l){return i(o)?void B(o,l,e,t,r,a,n):(O(e,n,a),void c())},o)},string:k,log:w}}]),angular.module("leaflet-directive").factory("leafletPathsHelpers",["$rootScope","$log","leafletHelpers",function(e,t,r){function a(e){return e.filter(function(e){return u(e)}).map(function(e){return n(e)})}function n(e){return s(e)?new L.LatLng(e[0],e[1]):new L.LatLng(e.lat,e.lng)}function o(e){return e.map(function(e){return a(e)})}function i(e,t){for(var r={},a=0;a<d.length;a++){var n=d[a];l(e[n])?r[n]=e[n]:l(t.path[n])&&(r[n]=t.path[n])}return r}var l=r.isDefined,s=r.isArray,c=r.isNumber,u=r.isValidPoint,d=["stroke","weight","color","opacity","fill","fillColor","fillOpacity","dashArray","lineCap","lineJoin","clickable","pointerEvents","className","smoothFactor","noClip"],f=function(e,t){for(var r={},a=0;a<d.length;a++){var n=d[a];l(t[n])&&(r[n]=t[n])}e.setStyle(t)},p=function(e){if(!s(e))return!1;for(var t=0;t<e.length;t++){var r=e[t];if(!u(r))return!1}return!0},g={polyline:{isValid:function(e){var t=e.latlngs;return p(t)},createPath:function(e){return new L.Polyline([],e)},setPath:function(e,t){e.setLatLngs(a(t.latlngs)),f(e,t)}},multiPolyline:{isValid:function(e){var t=e.latlngs;if(!s(t))return!1;for(var r in t){var a=t[r];if(!p(a))return!1}return!0},createPath:function(e){return new L.multiPolyline([[[0,0],[1,1]]],e)},setPath:function(e,t){e.setLatLngs(o(t.latlngs)),f(e,t)}},polygon:{isValid:function(e){var t=e.latlngs;return p(t)},createPath:function(e){return new L.Polygon([],e)},setPath:function(e,t){e.setLatLngs(a(t.latlngs)),f(e,t)}},multiPolygon:{isValid:function(e){var t=e.latlngs;if(!s(t))return!1;for(var r in t){var a=t[r];if(!p(a))return!1}return!0},createPath:function(e){return new L.MultiPolygon([[[0,0],[1,1],[0,1]]],e)},setPath:function(e,t){e.setLatLngs(o(t.latlngs)),f(e,t)}},rectangle:{isValid:function(e){var t=e.latlngs;if(!s(t)||2!==t.length)return!1;for(var r in t){var a=t[r];if(!u(a))return!1}return!0},createPath:function(e){return new L.Rectangle([[0,0],[1,1]],e)},setPath:function(e,t){e.setBounds(new L.LatLngBounds(a(t.latlngs))),f(e,t)}},circle:{isValid:function(e){var t=e.latlngs;return u(t)&&c(e.radius)},createPath:function(e){return new L.Circle([0,0],1,e)},setPath:function(e,t){e.setLatLng(n(t.latlngs)),l(t.radius)&&e.setRadius(t.radius),f(e,t)}},circleMarker:{isValid:function(e){var t=e.latlngs;return u(t)&&c(e.radius)},createPath:function(e){return new L.CircleMarker([0,0],e)},setPath:function(e,t){e.setLatLng(n(t.latlngs)),l(t.radius)&&e.setRadius(t.radius),f(e,t)}}},v=function(e){var t={};return e.latlngs&&(t.latlngs=e.latlngs),e.radius&&(t.radius=e.radius),t};return{setPathOptions:function(e,t,r){l(t)||(t="polyline"),g[t].setPath(e,r)},createPath:function(e,r,a){l(r.type)||(r.type="polyline");var n=i(r,a),o=v(r);return g[r.type].isValid(o)?g[r.type].createPath(n):void t.error("[AngularJS - Leaflet] Invalid data passed to the "+r.type+" path")}}}]),angular.module("leaflet-directive").service("leafletWatchHelpers",function(){var e=function(e,t,r,a,n){var o=e[t](r,function(e,t){n(e,t),a.doWatch||o()},a.isDeep);return o},t=function(t,r,a,n){return e(t,"$watch",r,a,n)},r=function(t,r,a,n){return e(t,"$watchCollection",r,a,n)};return{maybeWatch:t,maybeWatchCollection:r}}),angular.module("leaflet-directive").factory("nominatimService",["$q","$http","leafletHelpers","leafletMapDefaults",function(e,t,r,a){var n=r.isDefined;return{query:function(r,o){var i=a.getDefaults(o),l=i.nominatim.server,s=e.defer();return t.get(l,{params:{format:"json",limit:1,q:r}}).success(function(e){e.length>0&&n(e[0].boundingbox)?s.resolve(e[0]):s.reject("[Nominatim] Invalid address")}),s.promise}}}]),angular.module("leaflet-directive").directive("bounds",["$log","$timeout","$http","leafletHelpers","nominatimService","leafletBoundsHelpers",function(e,t,r,a,n,o){return{restrict:"A",scope:!1,replace:!1,require:["leaflet"],link:function(r,i,l,s){var c=a.isDefined,u=o.createLeafletBounds,d=s[0].getLeafletScope(),f=s[0],p=a.errorHeader+" [Bounds] ",g=function(e){return 0===e._southWest.lat&&0===e._southWest.lng&&0===e._northEast.lat&&0===e._northEast.lng};f.getMap().then(function(a){d.$on("boundsChanged",function(e){var r=e.currentScope,n=a.getBounds();if(!g(n)&&!r.settingBoundsFromScope){r.settingBoundsFromLeaflet=!0;var o={northEast:{lat:n._northEast.lat,lng:n._northEast.lng},southWest:{lat:n._southWest.lat,lng:n._southWest.lng},options:n.options};angular.equals(r.bounds,o)||(r.bounds=o),t(function(){r.settingBoundsFromLeaflet=!1})}});var o;d.$watch("bounds",function(i){if(!r.settingBoundsFromLeaflet){if(c(i.address)&&i.address!==o)return r.settingBoundsFromScope=!0,n.query(i.address,l.id).then(function(e){var t=e.boundingbox,r=[[t[0],t[2]],[t[1],t[3]]];a.fitBounds(r)},function(t){e.error(p+" "+t+".")}),o=i.address,void t(function(){r.settingBoundsFromScope=!1});var s=u(i);s&&!a.getBounds().equals(s)&&(r.settingBoundsFromScope=!0,a.fitBounds(s,i.options),t(function(){r.settingBoundsFromScope=!1}))}},!0)})}}}]);var centerDirectiveTypes=["center","lfCenter"],centerDirectives={};centerDirectiveTypes.forEach(function(e){centerDirectives[e]=["$log","$q","$location","$timeout","leafletMapDefaults","leafletHelpers","leafletBoundsHelpers","leafletMapEvents",function(t,r,a,n,o,i,l,s){var c,u=i.isDefined,d=i.isNumber,f=i.isSameCenterOnMap,p=i.safeApply,g=i.isValidCenter,v=l.isValidBounds,y=i.isUndefinedOrEmpty,h=i.errorHeader,m=function(e,t){return u(e)&&v(e)&&y(t)};return{restrict:"A",scope:!1,replace:!1,require:"leaflet",controller:function(){c=r.defer(),this.getCenter=function(){return c.promise}},link:function(r,i,v,y){var L=y.getLeafletScope(),b=L[e];y.getMap().then(function(r){var i=o.getDefaults(v.id);if(-1!==v[e].search("-"))return t.error(h+' The "center" variable can\'t use a "-" on its key name: "'+v[e]+'".'),void r.setView([i.center.lat,i.center.lng],i.center.zoom);if(m(L.bounds,b))r.fitBounds(l.createLeafletBounds(L.bounds),L.bounds.options),b=r.getCenter(),p(L,function(t){angular.extend(t[e],{lat:r.getCenter().lat,lng:r.getCenter().lng,zoom:r.getZoom(),autoDiscover:!1})}),p(L,function(e){var t=r.getBounds();e.bounds={northEast:{lat:t._northEast.lat,lng:t._northEast.lng},southWest:{lat:t._southWest.lat,lng:t._southWest.lng}}});else{if(!u(b))return t.error(h+' The "center" property is not defined in the main scope'),void r.setView([i.center.lat,i.center.lng],i.center.zoom);u(b.lat)&&u(b.lng)||u(b.autoDiscover)||angular.copy(i.center,b)}var y,C;if("yes"===v.urlHashCenter){var P=function(){var e,t=a.search();if(u(t.c)){var r=t.c.split(":");3===r.length&&(e={lat:parseFloat(r[0]),lng:parseFloat(r[1]),zoom:parseInt(r[2],10)})}return e};y=P(),L.$on("$locationChangeSuccess",function(t){var a=t.currentScope,n=P();u(n)&&!f(n,r)&&angular.extend(a[e],{lat:n.lat,lng:n.lng,zoom:n.zoom})})}L.$watch(e,function(e){return L.settingCenterFromLeaflet?void 0:(u(y)&&(angular.copy(y,e),y=void 0),g(e)||e.autoDiscover===!0?e.autoDiscover===!0?(d(e.zoom)||r.setView([i.center.lat,i.center.lng],i.center.zoom),void(d(e.zoom)&&e.zoom>i.center.zoom?r.locate({setView:!0,maxZoom:e.zoom}):u(i.maxZoom)?r.locate({setView:!0,maxZoom:i.maxZoom}):r.locate({setView:!0}))):void(C&&f(e,r)||(L.settingCenterFromScope=!0,r.setView([e.lat,e.lng],e.zoom),s.notifyCenterChangedToBounds(L,r),n(function(){L.settingCenterFromScope=!1}))):void t.warn(h+" invalid 'center'"))},!0),r.whenReady(function(){C=!0}),r.on("moveend",function(){c.resolve(),s.notifyCenterUrlHashChanged(L,r,v,a.search()),f(b,r)||L.settingCenterFromScope||(L.settingCenterFromLeaflet=!0,p(L,function(t){L.settingCenterFromScope||angular.extend(t[e],{lat:r.getCenter().lat,lng:r.getCenter().lng,zoom:r.getZoom(),autoDiscover:!1}),s.notifyCenterChangedToBounds(L,r),n(function(){L.settingCenterFromLeaflet=!1})}))}),b.autoDiscover===!0&&r.on("locationerror",function(){t.warn(h+" The Geolocation API is unauthorized on this page."),g(b)?(r.setView([b.lat,b.lng],b.zoom),s.notifyCenterChangedToBounds(L,r)):(r.setView([i.center.lat,i.center.lng],i.center.zoom),s.notifyCenterChangedToBounds(L,r))})})}}}]}),centerDirectiveTypes.forEach(function(e){angular.module("leaflet-directive").directive(e,centerDirectives[e])}),angular.module("leaflet-directive").directive("controls",["$log","leafletHelpers","leafletControlHelpers",function(e,t,r){return{restrict:"A",scope:!1,replace:!1,require:"?^leaflet",link:function(a,n,o,i){if(i){var l=r.createControl,s=r.isValidControlType,c=i.getLeafletScope(),u=t.isDefined,d=t.isArray,f={},p=t.errorHeader+" [Controls] ";i.getMap().then(function(t){c.$watchCollection("controls",function(r){for(var a in f)u(r[a])||(t.hasControl(f[a])&&t.removeControl(f[a]),delete f[a]);for(var n in r){var o,i=u(r[n].type)?r[n].type:n;if(!s(i))return void e.error(p+" Invalid control type: "+i+".");if("custom"!==i)o=l(i,r[n]),t.addControl(o),f[n]=o;else{var c=r[n];if(d(c))for(var g in c){var v=c[g];t.addControl(v),f[n]=u(f[n])?f[n].concat([v]):[v]}else t.addControl(c),f[n]=c}}})})}}}}]),angular.module("leaflet-directive").directive("decorations",["$log","leafletHelpers",function(e,t){return{restrict:"A",scope:!1,replace:!1,require:"leaflet",link:function(r,a,n,o){function i(t){return u(t)&&u(t.coordinates)&&(c.isLoaded()||e.error("[AngularJS - Leaflet] The PolylineDecorator Plugin is not loaded.")),L.polylineDecorator(t.coordinates)}function l(e,t){return u(e)&&u(t)&&u(t.coordinates)&&u(t.patterns)?(e.setPaths(t.coordinates),e.setPatterns(t.patterns),e):void 0}var s=o.getLeafletScope(),c=t.PolylineDecoratorPlugin,u=t.isDefined,d={};o.getMap().then(function(e){s.$watch("decorations",function(t){for(var r in d)u(t[r])&&angular.equals(t[r],d)||(e.removeLayer(d[r]),delete d[r]);for(var a in t){var n=t[a],o=i(n);u(o)&&(d[a]=o,e.addLayer(o),l(o,n))}},!0)})}}}]),angular.module("leaflet-directive").directive("eventBroadcast",["$log","$rootScope","leafletHelpers","leafletMapEvents","leafletIterators",function(e,t,r,a,n){return{restrict:"A",scope:!1,replace:!1,require:"leaflet",link:function(t,o,i,l){var s=r.isObject,c=r.isDefined,u=l.getLeafletScope(),d=u.eventBroadcast,f=a.getAvailableMapEvents(),p=a.addEvents;l.getMap().then(function(t){var r=[],a="broadcast";c(d.map)?s(d.map)?("emit"!==d.map.logic&&"broadcast"!==d.map.logic?e.warn("[AngularJS - Leaflet] Available event propagation logic are: 'emit' or 'broadcast'."):a=d.map.logic,s(d.map.enable)&&d.map.enable.length>=0?n.each(d.map.enable,function(e){-1===r.indexOf(e)&&-1!==f.indexOf(e)&&r.push(e)}):e.warn("[AngularJS - Leaflet] event-broadcast.map.enable must be an object check your model.")):e.warn("[AngularJS - Leaflet] event-broadcast.map must be an object check your model."):r=f,p(t,r,"eventName",u,a)})}}}]),angular.module("leaflet-directive").directive("geojson",["$log","$rootScope","leafletData","leafletHelpers","leafletWatchHelpers","leafletDirectiveControlsHelpers","leafletIterators","leafletGeoJsonEvents",function(e,t,r,a,n,o,i,l){var s=n.maybeWatch,c=a.watchOptions,u=o.extend,d=a,f=i;return{restrict:"A",scope:!1,replace:!1,require:"leaflet",link:function(e,t,n,o){var i=a.isDefined,p=o.getLeafletScope(),g={},v=!1;o.getMap().then(function(e){var t=p.geojsonWatchOptions||c,o=function(e,t){var r;return r=angular.isFunction(e.onEachFeature)?e.onEachFeature:function(r,o){a.LabelPlugin.isLoaded()&&i(r.properties.description)&&o.bindLabel(r.properties.description),l.bindEvents(n.id,o,null,r,p,t,{resetStyleOnMouseout:e.resetStyleOnMouseout,mapId:n.id})}},y=d.isDefined(n.geojsonNested)&&d.isTruthy(n.geojsonNested),h=function(){if(g){var t=function(t){i(t)&&e.hasLayer(t)&&e.removeLayer(t)};return y?void f.each(g,function(e){t(e)}):void t(g)}},m=function(t,a){var l=angular.copy(t);if(i(l)&&i(l.data)){var s=o(l,a);i(l.options)||(l.options={style:l.style,filter:l.filter,onEachFeature:s,pointToLayer:l.pointToLayer});var c=L.geoJson(l.data,l.options);a&&d.isString(a)?g[a]=c:g=c,c.addTo(e),v||(v=!0,r.setGeoJSON(g,n.id))}},b=function(e){if(h(),y){if(!e||!Object.keys(e).length)return;return void f.each(e,function(e,t){m(e,t)})}m(e)};u(n.id,"geojson",b,h),s(p,"geojson",t,function(e){b(e)})})}}}]),angular.module("leaflet-directive").directive("layercontrol",["$filter","$log","leafletData","leafletHelpers",function(e,t,r,a){return{restrict:"E",scope:{icons:"=?",autoHideOpacity:"=?",showGroups:"=?",title:"@",baseTitle:"@",overlaysTitle:"@"},replace:!0,transclude:!1,require:"^leaflet",controller:["$scope","$element","$sce",function(e,n,o){t.debug("[Angular Directive - Layers] layers",e,n);var i=a.safeApply,l=a.isDefined;angular.extend(e,{baselayer:"",oldGroup:"",layerProperties:{},groupProperties:{},rangeIsSupported:a.rangeIsSupported(),changeBaseLayer:function(t,n){a.safeApply(e,function(a){a.baselayer=t,r.getMap().then(function(n){r.getLayers().then(function(r){if(!n.hasLayer(r.baselayers[t])){for(var o in a.layers.baselayers)a.layers.baselayers[o].icon=a.icons.unradio,n.hasLayer(r.baselayers[o])&&n.removeLayer(r.baselayers[o]);n.addLayer(r.baselayers[t]),a.layers.baselayers[t].icon=e.icons.radio}})})}),n.preventDefault()},moveLayer:function(t,r,a){var n=Object.keys(e.layers.baselayers).length;if(r>=1+n&&r<=e.overlaysArray.length+n){var o;for(var l in e.layers.overlays)if(e.layers.overlays[l].index===r){
o=e.layers.overlays[l];break}o&&i(e,function(){o.index=t.index,t.index=r})}a.stopPropagation(),a.preventDefault()},initIndex:function(t,r){var a=Object.keys(e.layers.baselayers).length;t.index=l(t.index)?t.index:r+a+1},initGroup:function(t){e.groupProperties[t]=e.groupProperties[t]?e.groupProperties[t]:{}},toggleOpacity:function(t,r){if(r.visible){if(e.autoHideOpacity&&!e.layerProperties[r.name].opacityControl)for(var a in e.layerProperties)e.layerProperties[a].opacityControl=!1;e.layerProperties[r.name].opacityControl=!e.layerProperties[r.name].opacityControl}t.stopPropagation(),t.preventDefault()},toggleLegend:function(t){e.layerProperties[t.name].showLegend=!e.layerProperties[t.name].showLegend},showLegend:function(t){return t.legend&&e.layerProperties[t.name].showLegend},unsafeHTML:function(e){return o.trustAsHtml(e)},getOpacityIcon:function(t){return t.visible&&e.layerProperties[t.name].opacityControl?e.icons.close:e.icons.open},getGroupIcon:function(t){return t.visible?e.icons.check:e.icons.uncheck},changeOpacity:function(t){var a=e.layerProperties[t.name].opacity;r.getMap().then(function(n){r.getLayers().then(function(r){var o;for(var i in e.layers.overlays)if(e.layers.overlays[i]===t){o=r.overlays[i];break}n.hasLayer(o)&&(o.setOpacity&&o.setOpacity(a/100),o.getLayers&&o.eachLayer&&o.eachLayer(function(e){e.setOpacity&&e.setOpacity(a/100)}))})})},changeGroupVisibility:function(t){if(l(e.groupProperties[t])){var r=e.groupProperties[t].visible;for(var a in e.layers.overlays){var n=e.layers.overlays[a];n.group===t&&(n.visible=r)}}}});var s=n.get(0);L.Browser.touch?L.DomEvent.on(s,"click",L.DomEvent.stopPropagation):(L.DomEvent.disableClickPropagation(s),L.DomEvent.on(s,"mousewheel",L.DomEvent.stopPropagation))}],template:'<div class="angular-leaflet-control-layers" ng-show="overlaysArray.length"><h4 ng-if="title">{{ title }}</h4><div class="lf-baselayers"><h5 class="lf-title" ng-if="baseTitle">{{ baseTitle }}</h5><div class="lf-row" ng-repeat="(key, layer) in baselayersArray"><label class="lf-icon-bl" ng-click="changeBaseLayer(key, $event)"><input class="leaflet-control-layers-selector" type="radio" name="lf-radio" ng-show="false" ng-checked="baselayer === key" ng-value="key" /> <i class="lf-icon lf-icon-radio" ng-class="layer.icon"></i><div class="lf-text">{{layer.name}}</div></label></div></div><div class="lf-overlays"><h5 class="lf-title" ng-if="overlaysTitle">{{ overlaysTitle }}</h5><div class="lf-container"><div class="lf-row" ng-repeat="layer in (o = (overlaysArray | orderBy:\'index\':order))" ng-init="initIndex(layer, $index)"><label class="lf-icon-ol-group" ng-if="showGroups &amp;&amp; layer.group &amp;&amp; layer.group != o[$index-1].group"><input class="lf-control-layers-selector" type="checkbox" ng-show="false" ng-change="changeGroupVisibility(layer.group)" ng-model="groupProperties[layer.group].visible"/> <i class="lf-icon lf-icon-check" ng-class="getGroupIcon(groupProperties[layer.group])"></i><div class="lf-text">{{ layer.group }}</div></label><label class="lf-icon-ol"><input class="lf-control-layers-selector" type="checkbox" ng-show="false" ng-model="layer.visible"/> <i class="lf-icon lf-icon-check" ng-class="layer.icon"></i><div class="lf-text">{{layer.name}}</div></label><div class="lf-icons"><i class="lf-icon lf-up" ng-class="icons.up" ng-click="moveLayer(layer, layer.index - orderNumber, $event)"></i> <i class="lf-icon lf-down" ng-class="icons.down" ng-click="moveLayer(layer, layer.index + orderNumber, $event)"></i> <i class="lf-icon lf-toggle-legend" ng-class="icons.toggleLegend" ng-if="layer.legend" ng-click="toggleLegend(layer)"></i> <i class="lf-icon lf-open" ng-class="getOpacityIcon(layer)" ng-click="toggleOpacity($event, layer)"></i></div><div class="lf-legend" ng-if="showLegend(layer)" ng-bind-html="unsafeHTML(layer.legend)"></div><div class="lf-opacity clearfix" ng-if="layer.visible &amp;&amp; layerProperties[layer.name].opacityControl"><label ng-if="rangeIsSupported" class="pull-left" style="width: 50%">0</label><label ng-if="rangeIsSupported" class="pull-left text-right" style="width: 50%">100</label><input ng-if="rangeIsSupported" class="clearfix" type="range" min="0" max="100" class="lf-opacity-control" ng-model="layerProperties[layer.name].opacity" ng-change="changeOpacity(layer)"/><h6 ng-if="!rangeIsSupported">Range is not supported in this browser</h6></div></div></div></div></div>',link:function(e,t,n,o){var i=a.isDefined,l=o.getLeafletScope(),s=l.layers;e.$watch("icons",function(){var t={uncheck:"fa fa-square-o",check:"fa fa-check-square-o",radio:"fa fa-dot-circle-o",unradio:"fa fa-circle-o",up:"fa fa-angle-up",down:"fa fa-angle-down",open:"fa fa-angle-double-down",close:"fa fa-angle-double-up",toggleLegend:"fa fa-pencil-square-o"};i(e.icons)?(angular.extend(t,e.icons),angular.extend(e.icons,t)):e.icons=t}),n.order=!i(n.order)||"normal"!==n.order&&"reverse"!==n.order?"normal":n.order,e.order="normal"===n.order,e.orderNumber="normal"===n.order?-1:1,e.layers=s,o.getMap().then(function(t){l.$watch("layers.baselayers",function(a){var n={};r.getLayers().then(function(r){var o;for(o in a){var i=a[o];i.icon=e.icons[t.hasLayer(r.baselayers[o])?"radio":"unradio"],n[o]=i}e.baselayersArray=n})}),l.$watch("layers.overlays",function(t){var a=[],n={};r.getLayers().then(function(r){var o;for(o in t){var l=t[o];l.icon=e.icons[l.visible?"check":"uncheck"],a.push(l),i(e.layerProperties[l.name])||(e.layerProperties[l.name]={opacity:i(l.layerOptions.opacity)?100*l.layerOptions.opacity:100,opacityControl:!1,showLegend:!0}),i(l.group)&&(i(e.groupProperties[l.group])||(e.groupProperties[l.group]={visible:!1}),n[l.group]=i(n[l.group])?n[l.group]:{count:0,visibles:0},n[l.group].count++,l.visible&&n[l.group].visibles++),i(l.index)&&r.overlays[o].setZIndex&&r.overlays[o].setZIndex(t[o].index)}for(o in n)e.groupProperties[o].visible=n[o].visibles===n[o].count;e.overlaysArray=a})},!0)})}}}]),angular.module("leaflet-directive").directive("layers",["$log","$q","leafletData","leafletHelpers","leafletLayerHelpers","leafletControlHelpers",function(e,t,r,a,n,o){return{restrict:"A",scope:!1,replace:!1,require:"leaflet",controller:["$scope",function(e){e._leafletLayers=t.defer(),this.getLayers=function(){return e._leafletLayers.promise}}],link:function(e,t,i,l){var s=a.isDefined,c={},u=l.getLeafletScope(),d=u.layers,f=n.createLayer,p=n.safeAddLayer,g=n.safeRemoveLayer,v=o.updateLayersControl,y=!1;l.getMap().then(function(t){e._leafletLayers.resolve(c),r.setLayers(c,i.id),c.baselayers={},c.overlays={};var a=i.id,n=!1;for(var o in d.baselayers){var l=f(d.baselayers[o]);s(l)?(c.baselayers[o]=l,d.baselayers[o].top===!0&&(p(t,c.baselayers[o]),n=!0)):delete d.baselayers[o]}!n&&Object.keys(c.baselayers).length>0&&p(t,c.baselayers[Object.keys(d.baselayers)[0]]);for(o in d.overlays){var h=f(d.overlays[o]);s(h)?(c.overlays[o]=h,d.overlays[o].visible===!0&&p(t,c.overlays[o])):delete d.overlays[o]}u.$watch("layers.baselayers",function(e,r){if(angular.equals(e,r))return y=v(t,a,y,e,d.overlays,c),!0;for(var n in c.baselayers)(!s(e[n])||e[n].doRefresh)&&(t.hasLayer(c.baselayers[n])&&t.removeLayer(c.baselayers[n]),delete c.baselayers[n],e[n]&&e[n].doRefresh&&(e[n].doRefresh=!1));for(var o in e)if(s(c.baselayers[o]))e[o].top!==!0||t.hasLayer(c.baselayers[o])?e[o].top===!1&&t.hasLayer(c.baselayers[o])&&t.removeLayer(c.baselayers[o]):p(t,c.baselayers[o]);else{var i=f(e[o]);s(i)&&(c.baselayers[o]=i,e[o].top===!0&&p(t,c.baselayers[o]))}var l=!1;for(var u in c.baselayers)if(t.hasLayer(c.baselayers[u])){l=!0;break}!l&&Object.keys(c.baselayers).length>0&&p(t,c.baselayers[Object.keys(c.baselayers)[0]]),y=v(t,a,y,e,d.overlays,c)},!0),u.$watch("layers.overlays",function(e,r){if(angular.equals(e,r))return y=v(t,a,y,d.baselayers,e,c),!0;for(var n in c.overlays)if(!s(e[n])||e[n].doRefresh){if(t.hasLayer(c.overlays[n])){var o=s(e[n])?e[n].layerOptions:null;g(t,c.overlays[n],o)}delete c.overlays[n],e[n]&&e[n].doRefresh&&(e[n].doRefresh=!1)}for(var i in e){if(s(c.overlays[i]))e[i].visible&&!t.hasLayer(c.overlays[i])?p(t,c.overlays[i]):e[i].visible===!1&&t.hasLayer(c.overlays[i])&&g(t,c.overlays[i],e[i].layerOptions);else{var l=f(e[i]);if(!s(l))continue;c.overlays[i]=l,e[i].visible===!0&&p(t,c.overlays[i])}e[i].visible&&t._loaded&&e[i].data&&"heatmap"===e[i].type&&(c.overlays[i].setData(e[i].data),c.overlays[i].update())}y=v(t,a,y,d.baselayers,e,c)},!0)})}}}]),angular.module("leaflet-directive").directive("legend",["$log","$http","leafletHelpers","leafletLegendHelpers",function(e,t,r,a){return{restrict:"A",scope:!1,replace:!1,require:"leaflet",link:function(n,o,i,l){var s,c,u,d,f=r.isArray,p=r.isDefined,g=r.isFunction,v=l.getLeafletScope(),y=v.legend;v.$watch("legend",function(e){p(e)&&(s=e.legendClass?e.legendClass:"legend",c=e.position||"bottomright",d=e.type||"arcgis")},!0),l.getMap().then(function(r){v.$watch("legend",function(t){return p(t)?p(t.url)||"arcgis"!==d||f(t.colors)&&f(t.labels)&&t.colors.length===t.labels.length?p(t.url)?void e.info("[AngularJS - Leaflet] loading legend service."):(p(u)&&(u.removeFrom(r),u=null),u=L.control({position:c}),"arcgis"===d&&(u.onAdd=a.getOnAddArrayLegend(t,s)),void u.addTo(r)):void e.warn("[AngularJS - Leaflet] legend.colors and legend.labels must be set."):void(p(u)&&(u.removeFrom(r),u=null))}),v.$watch("legend.url",function(n){p(n)&&t.get(n).success(function(e){p(u)?a.updateLegend(u.getContainer(),e,d,n):(u=L.control({position:c}),u.onAdd=a.getOnAddLegend(e,s,d,n),u.addTo(r)),p(y.loadedData)&&g(y.loadedData)&&y.loadedData()}).error(function(){e.warn("[AngularJS - Leaflet] legend.url not loaded.")})})})}}}]),angular.module("leaflet-directive").directive("markers",["$log","$rootScope","$q","leafletData","leafletHelpers","leafletMapDefaults","leafletMarkersHelpers","leafletMarkerEvents","leafletIterators","leafletWatchHelpers","leafletDirectiveControlsHelpers",function(e,t,r,a,n,o,i,l,s,c,u){var d=n.isDefined,f=n.errorHeader,p=n,g=n.isString,v=i.addMarkerWatcher,y=i.updateMarker,h=i.listenMarkerEvents,m=i.addMarkerToGroup,b=i.createMarker,C=i.deleteMarker,P=s,k=n.watchOptions,w=c.maybeWatch,D=u.extend,A=function(e,t,r){if(Object.keys(e).length){if(r&&g(r)){if(!e[r]||!Object.keys(e[r]).length)return;return e[r][t]}return e[t]}},S=function(e,t,r,a){return a&&g(a)?(d(t[a])||(t[a]={}),t[a][r]=e):t[r]=e,e},O=function(t,r,a,n,o,i){if(!g(t))return e.error(f+" A layername must be a string"),!1;if(!d(r))return e.error(f+" You must add layers to the directive if the markers are going to use this functionality."),!1;if(!d(r.overlays)||!d(r.overlays[t]))return e.error(f+' A marker can only be added to a layer of type "group"'),!1;var l=r.overlays[t];return l instanceof L.LayerGroup||l instanceof L.FeatureGroup?(l.addLayer(n),!o&&i.hasLayer(n)&&a.focus===!0&&n.openPopup(),!0):(e.error(f+' Adding a marker to an overlay needs a overlay of the type "group" or "featureGroup"'),!1)},M=function(t,r,a,n,o,i,s,c,u,g){for(var L in r)if(!g[L])if(-1===L.search("-")){var C=p.copy(r[L]),P=p.getObjectDotPath(u?[u,L]:[L]),k=A(i,L,u);if(d(k)){var w=d(w)?a[L]:void 0;y(C,w,k,P,s,o,n)}else{var D=b(C),M=(C?C.layer:void 0)||u;if(!d(D)){e.error(f+" Received invalid data on the marker "+L+".");continue}if(S(D,i,L,u),d(C.message)&&D.bindPopup(C.message,C.popupOptions),d(C.group)){var H=d(C.groupOption)?C.groupOption:null;m(D,C.group,H,n)}if(p.LabelPlugin.isLoaded()&&d(C.label)&&d(C.label.message)&&D.bindLabel(C.label.message,C.label.options),d(C)&&(d(C.layer)||d(u))){var $=O(M,o,C,D,c.individual.doWatch,n);if(!$)continue}else d(C.group)||(n.addLayer(D),c.individual.doWatch||C.focus!==!0||D.openPopup());c.individual.doWatch&&v(D,P,s,o,n,c.individual.isDeep),h(D,C,s,c.individual.doWatch,n),l.bindEvents(t,D,P,C,s,M)}}else e.error('The marker can\'t use a "-" on his key name: "'+L+'".')},H=function(t,r,a,n,o){var i,l,s=!1,c=!1,u=d(r);for(var g in a)s||(e.debug(f+"[markers] destroy: "),s=!0),u&&(l=t[g],i=r[g],c=angular.equals(l,i)&&n),d(t)&&Object.keys(t).length&&d(t[g])&&Object.keys(t[g]).length&&!c||o&&p.isFunction(o)&&o(l,i,g)},$=function(t,r,a,n,o){H(t,r,a,!1,function(t,r,i){e.debug(f+"[marker] is deleting marker: "+i),C(a[i],n,o),delete a[i]})},E=function(t,r,a){var n={};return H(t,r,a,!0,function(t,r,a){e.debug(f+"[marker] is already rendered, marker: "+a),n[a]=t}),n};return{restrict:"A",scope:!1,replace:!1,require:["leaflet","?layers"],link:function(e,t,n,o){var i=o[0],l=i.getLeafletScope();i.getMap().then(function(e){var t,i={};t=d(o[1])?o[1].getLayers:function(){var e=r.defer();return e.resolve(),e.promise};var s=l.markersWatchOptions||k;d(n.watchMarkers)&&(s.doWatch=s.individual.doWatch=!d(n.watchMarkers)||p.isTruthy(n.watchMarkers));var c=d(n.markersNested)&&p.isTruthy(n.markersNested);t().then(function(t){var r=function(r,a){return c?void P.each(r,function(r,n){var o=d(o)?a[n]:void 0;$(r,o,i[n],e,t)}):void $(r,a,i,e,t)},o=function(a,o){r(a,o);var u=null;return c?void P.each(a,function(r,c){var f=d(f)?o[c]:void 0;u=E(a[c],f,i[c]),M(n.id,r,o,e,t,i,l,s,c,u)}):(u=E(a,o,i),void M(n.id,a,o,e,t,i,l,s,void 0,u))};D(n.id,"markers",o,r),a.setMarkers(i,n.id),w(l,"markers",s,function(e,t){o(e,t)})})})}}}]),angular.module("leaflet-directive").directive("maxbounds",["$log","leafletMapDefaults","leafletBoundsHelpers","leafletHelpers",function(e,t,r,a){return{restrict:"A",scope:!1,replace:!1,require:"leaflet",link:function(e,t,n,o){var i=o.getLeafletScope(),l=r.isValidBounds,s=a.isNumber;o.getMap().then(function(e){i.$watch("maxbounds",function(t){if(!l(t))return void e.setMaxBounds();var a=r.createLeafletBounds(t);s(t.pad)&&(a=a.pad(t.pad)),e.setMaxBounds(a),n.center||n.lfCenter||e.fitBounds(a)})})}}}]),angular.module("leaflet-directive").directive("paths",["$log","$q","leafletData","leafletMapDefaults","leafletHelpers","leafletPathsHelpers","leafletPathEvents",function(e,t,r,a,n,o,i){return{restrict:"A",scope:!1,replace:!1,require:["leaflet","?layers"],link:function(l,s,c,u){var d=u[0],f=n.isDefined,p=n.isString,g=d.getLeafletScope(),v=g.paths,y=o.createPath,h=i.bindPathEvents,m=o.setPathOptions;d.getMap().then(function(o){var i,l=a.getDefaults(c.id);i=f(u[1])?u[1].getLayers:function(){var e=t.defer();return e.resolve(),e.promise},f(v)&&i().then(function(t){var a={};r.setPaths(a,c.id);var i=!f(c.watchPaths)||"true"===c.watchPaths,s=function(e,r){var a=g.$watch('paths["'+r+'"]',function(r,n){if(!f(r)){if(f(n.layer))for(var i in t.overlays){var l=t.overlays[i];l.removeLayer(e)}return o.removeLayer(e),void a()}m(e,r.type,r)},!0)};g.$watchCollection("paths",function(r){for(var u in a)f(r[u])||(o.removeLayer(a[u]),delete a[u]);for(var d in r)if(0!==d.search("\\$"))if(-1===d.search("-")){if(!f(a[d])){var v=r[d],b=y(d,r[d],l);if(f(b)&&f(v.message)&&b.bindPopup(v.message,v.popupOptions),n.LabelPlugin.isLoaded()&&f(v.label)&&f(v.label.message)&&b.bindLabel(v.label.message,v.label.options),f(v)&&f(v.layer)){if(!p(v.layer)){e.error("[AngularJS - Leaflet] A layername must be a string");continue}if(!f(t)){e.error("[AngularJS - Leaflet] You must add layers to the directive if the markers are going to use this functionality.");continue}if(!f(t.overlays)||!f(t.overlays[v.layer])){e.error('[AngularJS - Leaflet] A path can only be added to a layer of type "group"');continue}var C=t.overlays[v.layer];if(!(C instanceof L.LayerGroup||C instanceof L.FeatureGroup)){e.error('[AngularJS - Leaflet] Adding a path to an overlay needs a overlay of the type "group" or "featureGroup"');continue}a[d]=b,C.addLayer(b),i?s(b,d):m(b,v.type,v)}else f(b)&&(a[d]=b,o.addLayer(b),i?s(b,d):m(b,v.type,v));h(c.id,b,d,v,g)}}else e.error('[AngularJS - Leaflet] The path name "'+d+'" is not valid. It must not include "-" and a number.')})})})}}}]),angular.module("leaflet-directive").directive("tiles",["$log","leafletData","leafletMapDefaults","leafletHelpers",function(e,t,r,a){return{restrict:"A",scope:!1,replace:!1,require:"leaflet",link:function(n,o,i,l){var s=a.isDefined,c=l.getLeafletScope(),u=c.tiles;return s(u)&&s(u.url)?void l.getMap().then(function(e){var a,n=r.getDefaults(i.id);c.$watch("tiles",function(r,o){var l=n.tileLayerOptions,c=n.tileLayer;return!s(r.url)&&s(a)?void e.removeLayer(a):s(a)?!s(r.url)||!s(r.options)||r.type===o.type&&angular.equals(r.options,l)?void(s(r.url)&&a.setUrl(r.url)):(e.removeLayer(a),l=n.tileLayerOptions,angular.copy(r.options,l),c=r.url,a="wms"===r.type?L.tileLayer.wms(c,l):L.tileLayer(c,l),a.addTo(e),void t.setTiles(a,i.id)):(s(r.options)&&angular.copy(r.options,l),s(r.url)&&(c=r.url),a="wms"===r.type?L.tileLayer.wms(c,l):L.tileLayer(c,l),a.addTo(e),void t.setTiles(a,i.id))},!0)}):void e.warn("[AngularJS - Leaflet] The 'tiles' definition doesn't have the 'url' property.")}}}]),["markers","geojson"].forEach(function(e){angular.module("leaflet-directive").directive(e+"WatchOptions",["$log","$rootScope","$q","leafletData","leafletHelpers",function(t,r,a,n,o){var i=o.isDefined,l=o.errorHeader,s=o.isObject,c=o.watchOptions;return{restrict:"A",scope:!1,replace:!1,require:["leaflet"],link:function(r,a,n,o){var u=o[0],d=u.getLeafletScope();u.getMap().then(function(){i(r[e+"WatchOptions"])&&(s(r[e+"WatchOptions"])?angular.extend(c,r[e+"WatchOptions"]):t.error(l+"["+e+"WatchOptions] is not an object"),d[e+"WatchOptions"]=c)})}}}])}),angular.module("leaflet-directive").factory("LeafletEventsHelpersFactory",["$rootScope","$q","$log","leafletHelpers",function(e,t,r,a){var n=a.safeApply,o=a.isDefined,i=a.isObject,l=a.isArray,s=a.errorHeader,c=function(e,t){this.rootBroadcastName=e,r.debug("LeafletEventsHelpersFactory: lObjectType: "+t+"rootBroadcastName: "+e),this.lObjectType=t};return c.prototype.getAvailableEvents=function(){return[]},c.prototype.genDispatchEvent=function(e,t,a,n,o,i,l,s,c){var u=this;return e=e||"",e&&(e="."+e),function(d){var f=u.rootBroadcastName+e+"."+t;r.debug(f),u.fire(n,f,a,d,d.target||o,l,i,s,c)}},c.prototype.fire=function(t,r,a,i,l,s,c,u){n(t,function(){var n={leafletEvent:i,leafletObject:l,modelName:c,model:s};o(u)&&angular.extend(n,{layerName:u}),"emit"===a?t.$emit(r,n):e.$broadcast(r,n)})},c.prototype.bindEvents=function(e,t,a,n,c,u,d){var f=[],p="emit",g=this;if(o(c.eventBroadcast))if(i(c.eventBroadcast))if(o(c.eventBroadcast[g.lObjectType]))if(i(c.eventBroadcast[g.lObjectType])){o(c.eventBroadcast[this.lObjectType].logic)&&"emit"!==c.eventBroadcast[g.lObjectType].logic&&"broadcast"!==c.eventBroadcast[g.lObjectType].logic&&r.warn(s+"Available event propagation logic are: 'emit' or 'broadcast'.");var v=!1,y=!1;o(c.eventBroadcast[g.lObjectType].enable)&&l(c.eventBroadcast[g.lObjectType].enable)&&(v=!0),o(c.eventBroadcast[g.lObjectType].disable)&&l(c.eventBroadcast[g.lObjectType].disable)&&(y=!0),v&&y?r.warn(s+"can not enable and disable events at the same time"):v||y?v?c.eventBroadcast[this.lObjectType].enable.forEach(function(e){-1!==f.indexOf(e)?r.warn(s+"This event "+e+" is already enabled"):-1===g.getAvailableEvents().indexOf(e)?r.warn(s+"This event "+e+" does not exist"):f.push(e)}):(f=this.getAvailableEvents(),c.eventBroadcast[g.lObjectType].disable.forEach(function(e){var t=f.indexOf(e);-1===t?r.warn(s+"This event "+e+" does not exist or has been already disabled"):f.splice(t,1)})):r.warn(s+"must enable or disable events")}else r.warn(s+"event-broadcast."+[g.lObjectType]+" must be an object check your model.");else f=this.getAvailableEvents();else r.error(s+"event-broadcast must be an object check your model.");else f=this.getAvailableEvents();return f.forEach(function(r){t.on(r,g.genDispatchEvent(e,r,p,c,t,a,n,u,d))}),p},c}]).service("leafletEventsHelpers",["LeafletEventsHelpersFactory",function(e){return new e}]),angular.module("leaflet-directive").factory("leafletGeoJsonEvents",["$rootScope","$q","$log","leafletHelpers","LeafletEventsHelpersFactory","leafletData",function(e,t,r,a,n,o){var i=a.safeApply,l=n,s=function(){l.call(this,"leafletDirectiveGeoJson","geojson")};return s.prototype=new l,s.prototype.genDispatchEvent=function(t,r,a,n,s,c,u,d,f){var p=l.prototype.genDispatchEvent.call(this,t,r,a,n,s,c,u,d),g=this;return function(t){"mouseout"===r&&(f.resetStyleOnMouseout&&o.getGeoJSON(f.mapId).then(function(e){var r=d?e[d]:e;r.resetStyle(t.target)}),i(n,function(){e.$broadcast(g.rootBroadcastName+".mouseout",t)})),p(t)}},s.prototype.getAvailableEvents=function(){return["click","dblclick","mouseover","mouseout"]},new s}]),angular.module("leaflet-directive").factory("leafletLabelEvents",["$rootScope","$q","$log","leafletHelpers","LeafletEventsHelpersFactory",function(e,t,r,a,n){var o=a,i=n,l=function(){i.call(this,"leafletDirectiveLabel","markers")};return l.prototype=new i,l.prototype.genDispatchEvent=function(e,t,r,a,n,o,l,s){var c=o.replace("markers.","");return i.prototype.genDispatchEvent.call(this,e,t,r,a,n,c,l,s)},l.prototype.getAvailableEvents=function(){return["click","dblclick","mousedown","mouseover","mouseout","contextmenu"]},l.prototype.genEvents=function(e,t,r,a,n,i,l,s){var c=this,u=this.getAvailableEvents(),d=o.getObjectArrayPath("markers."+i);u.forEach(function(t){n.label.on(t,c.genDispatchEvent(e,t,r,a,n.label,d,l,s))})},l.prototype.bindEvents=function(){},new l}]),angular.module("leaflet-directive").factory("leafletMapEvents",["$rootScope","$q","$log","leafletHelpers","leafletEventsHelpers","leafletIterators",function(e,t,r,a,n,o){var i=a.isDefined,l=n.fire,s=function(){return["click","dblclick","mousedown","mouseup","mouseover","mouseout","mousemove","contextmenu","focus","blur","preclick","load","unload","viewreset","movestart","move","moveend","dragstart","drag","dragend","zoomstart","zoomanim","zoomend","zoomlevelschange","resize","autopanstart","layeradd","layerremove","baselayerchange","overlayadd","overlayremove","locationfound","locationerror","popupopen","popupclose","draw:created","draw:edited","draw:deleted","draw:drawstart","draw:drawstop","draw:editstart","draw:editstop","draw:deletestart","draw:deletestop"]},c=function(e,t,a,n){return n&&(n+="."),function(o){var i="leafletDirectiveMap."+n+t;r.debug(i),l(e,i,a,o,o.target,e)}},u=function(e){e.$broadcast("boundsChanged")},d=function(e,t,r,a){if(i(r.urlHashCenter)){var n=t.getCenter(),o=n.lat.toFixed(4)+":"+n.lng.toFixed(4)+":"+t.getZoom();i(a.c)&&a.c===o||e.$emit("centerUrlHash",o)}},f=function(e,t,r,a,n){o.each(t,function(t){var o={};o[r]=t,e.on(t,c(a,t,n,e._container.id||""),o)})};return{getAvailableMapEvents:s,genDispatchMapEvent:c,notifyCenterChangedToBounds:u,notifyCenterUrlHashChanged:d,addEvents:f}}]),angular.module("leaflet-directive").factory("leafletMarkerEvents",["$rootScope","$q","$log","leafletHelpers","LeafletEventsHelpersFactory","leafletLabelEvents",function(e,t,r,a,n,o){var i=a.safeApply,l=a.isDefined,s=a,c=o,u=n,d=function(){u.call(this,"leafletDirectiveMarker","markers")};return d.prototype=new u,d.prototype.genDispatchEvent=function(t,r,a,n,o,l,s,c){var d=u.prototype.genDispatchEvent.call(this,t,r,a,n,o,l,s,c);return function(t){"click"===r?i(n,function(){e.$broadcast("leafletDirectiveMarkersClick",l)}):"dragend"===r&&(i(n,function(){s.lat=o.getLatLng().lat,s.lng=o.getLatLng().lng}),s.message&&s.focus===!0&&o.openPopup()),d(t)}},d.prototype.getAvailableEvents=function(){return["click","dblclick","mousedown","mouseover","mouseout","contextmenu","dragstart","drag","dragend","move","remove","popupopen","popupclose","touchend","touchstart","touchmove","touchcancel","touchleave"]},d.prototype.bindEvents=function(e,t,r,a,n,o){var i=u.prototype.bindEvents.call(this,e,t,r,a,n,o);s.LabelPlugin.isLoaded()&&l(t.label)&&c.genEvents(e,r,i,n,t,a,o)},new d}]),angular.module("leaflet-directive").factory("leafletPathEvents",["$rootScope","$q","$log","leafletHelpers","leafletLabelEvents","leafletEventsHelpers",function(e,t,r,a,n,o){var i=a.isDefined,l=a.isObject,s=a,c=a.errorHeader,u=n,d=o.fire,f=function(e,t,a,n,o,i,l,s){return e=e||"",e&&(e="."+e),function(c){var u="leafletDirectivePath"+e+"."+t;r.debug(u),d(n,u,a,c,c.target||o,l,i,s)}},p=function(e,t,a,n,o){var d,p,v=[],y="broadcast";if(i(o.eventBroadcast))if(l(o.eventBroadcast))if(i(o.eventBroadcast.path))if(l(o.eventBroadcast.paths))r.warn(c+"event-broadcast.path must be an object check your model.");else{void 0!==o.eventBroadcast.path.logic&&null!==o.eventBroadcast.path.logic&&("emit"!==o.eventBroadcast.path.logic&&"broadcast"!==o.eventBroadcast.path.logic?r.warn(c+"Available event propagation logic are: 'emit' or 'broadcast'."):"emit"===o.eventBroadcast.path.logic&&(y="emit"));var h=!1,m=!1;if(void 0!==o.eventBroadcast.path.enable&&null!==o.eventBroadcast.path.enable&&"object"==typeof o.eventBroadcast.path.enable&&(h=!0),void 0!==o.eventBroadcast.path.disable&&null!==o.eventBroadcast.path.disable&&"object"==typeof o.eventBroadcast.path.disable&&(m=!0),h&&m)r.warn(c+"can not enable and disable events at the same time");else if(h||m)if(h)for(d=0;d<o.eventBroadcast.path.enable.length;d++)p=o.eventBroadcast.path.enable[d],-1!==v.indexOf(p)?r.warn(c+"This event "+p+" is already enabled"):-1===g().indexOf(p)?r.warn(c+"This event "+p+" does not exist"):v.push(p);else for(v=g(),d=0;d<o.eventBroadcast.path.disable.length;d++){p=o.eventBroadcast.path.disable[d];var L=v.indexOf(p);-1===L?r.warn(c+"This event "+p+" does not exist or has been already disabled"):v.splice(L,1)}else r.warn(c+"must enable or disable events")}else v=g();else r.error(c+"event-broadcast must be an object check your model.");else v=g();for(d=0;d<v.length;d++)p=v[d],t.on(p,f(e,p,y,o,v,a));s.LabelPlugin.isLoaded()&&i(t.label)&&u.genEvents(e,a,y,o,t,n)},g=function(){return["click","dblclick","mousedown","mouseover","mouseout","contextmenu","add","remove","popupopen","popupclose"]};return{getAvailablePathEvents:g,bindPathEvents:p}}])}(angular)}(angular),function(e){"use strict";e.module("smart-table",[])}(angular),function(e,t){"use strict";e.module("smart-table").controller("stTableController",["$scope","$parse","$filter","$attrs",function(e,r,a,n){function o(e){return[].concat(e)}function i(){g=o(l(e)),y===!0&&h.pipe()}var l,s,c=n.stTable,u=r(c),d=u.assign,f=a("orderBy"),p=a("filter"),g=o(u(e)),v={sort:{},search:{},pagination:{start:0}},y=!0,h=this;n.stSafeSrc&&(l=r(n.stSafeSrc),e.$watch(function(){var t=l(e);return t?t.length:0},function(e,t){e!==t&&i()}),e.$watch(function(){return l(e)},function(e,t){e!==t&&i()})),this.sortBy=function(e,t){v.sort.predicate=e,v.sort.reverse=t===!0,v.pagination.start=0,this.pipe()},this.search=function(e,t){var r=v.search.predicateObject||{},a=t?t:"$";r[a]=e,e||delete r[a],v.search.predicateObject=r,v.pagination.start=0,this.pipe()},this.pipe=function(){var r=v.pagination,a=v.search.predicateObject?p(g,v.search.predicateObject):g;a=f(a,v.sort.predicate,v.sort.reverse),r.number!==t&&(r.numberOfPages=a.length>0?Math.ceil(a.length/r.number):1,r.start=r.start>=a.length?(r.numberOfPages-1)*r.number:r.start,a=a.slice(r.start,r.start+r.number)),d(e,a)},this.select=function(e,r){var a=g,n=a.indexOf(e);n!==-1&&("single"===r?(e.isSelected=e.isSelected!==!0,s&&(s.isSelected=!1),s=e.isSelected===!0?e:t):a[n].isSelected=!a[n].isSelected)},this.slice=function(e,t){v.pagination.start=e,v.pagination.number=t,this.pipe()},this.tableState=function(){return v},this.setFilterFunction=function(e){p=a(e)},this.setSortFunction=function(e){f=a(e)},this.preventPipeOnWatch=function(){y=!1}}]).directive("stTable",function(){return{restrict:"A",controller:"stTableController",link:function(e,t,r,a){}}})}(angular),function(e){"use strict";e.module("smart-table").directive("stSearch",["$timeout",function(e){return{replace:!0,require:"^stTable",scope:{predicate:"=?stSearch"},link:function(t,r,a,n){var o=n,i=null,l=a.stDelay||400;t.$watch("predicate",function(e,t){e!==t&&(n.tableState().search={},o.search(r[0].value||"",e))}),t.$watch(function(){return n.tableState().search},function(e,a){var n=t.predicate||"$";e.predicateObject&&e.predicateObject[n]!==r[0].value&&(r[0].value=e.predicateObject[n]||"")},!0),r.bind("input",function(r){r=r.originalEvent||r,null!==i&&e.cancel(i),i=e(function(){o.search(r.target.value,t.predicate||""),i=null},l)})}}}])}(angular),function(e){"use strict";e.module("smart-table").directive("stSelectRow",function(){return{restrict:"A",require:"^stTable",scope:{row:"=stSelectRow"},link:function(e,t,r,a){var n=r.stSelectMode||"single";t.bind("click",function(){e.$apply(function(){a.select(e.row,n)})}),e.$watch("row.isSelected",function(e,r){e===!0?t.addClass("st-selected"):t.removeClass("st-selected")})}}})}(angular),function(e,t){"use strict";e.module("smart-table").directive("stSort",["$parse",function(r){return{restrict:"A",require:"^stTable",link:function(a,n,o,i){function l(){u++,u%3===0?(u=0,i.tableState().sort={},i.tableState().pagination.start=0,i.pipe()):i.sortBy(s,u%2===0)}var s=o.stSort,c=r(s),u=0,d=o.stClassAscent||"st-sort-ascent",f=o.stClassDescent||"st-sort-descent",p=["st-sort-natural",d,f];e.isFunction(c(a))&&(s=c(a)),n.bind("click",function(){s&&a.$apply(l)}),o.stSortDefault!==t&&(u="reverse"===o.stSortDefault?1:0,l()),a.$watch(function(){return i.tableState().sort},function(e,t){e.predicate!==s?(u=0,n.removeClass(d).removeClass(f)):(u=e.reverse===!0?2:1,n.removeClass(p[(u+1)%2]).addClass(p[u]))},!0)}}}])}(angular),function(e){"use strict";e.module("smart-table").directive("stPagination",function(){return{restrict:"EA",require:"^stTable",scope:{stItemsByPage:"=?",stDisplayedPages:"=?"},template:'<div class="pagination" ng-if="pages.length >= 2"><ul class="pagination"><li ng-repeat="page in pages" ng-class="{active: page==currentPage}"><a ng-click="selectPage(page)">{{page}}</a></li></ul></div>',replace:!0,link:function(e,t,r,a){function n(){var t,r,n=a.tableState().pagination,o=1;for(e.currentPage=Math.floor(n.start/n.number)+1,o=Math.max(o,e.currentPage-Math.abs(Math.floor(e.stDisplayedPages/2))),t=o+e.stDisplayedPages,t>n.numberOfPages&&(t=n.numberOfPages+1,o=Math.max(1,t-e.stDisplayedPages)),e.pages=[],e.numPages=n.numberOfPages,r=o;r<t;r++)e.pages.push(r)}e.stItemsByPage=e.stItemsByPage?+e.stItemsByPage:10,e.stDisplayedPages=e.stDisplayedPages?+e.stDisplayedPages:5,e.currentPage=1,e.pages=[],e.$watch(function(){return a.tableState().pagination},n,!0),e.$watch("stItemsByPage",function(){e.selectPage(1)}),e.$watch("stDisplayedPages",n),e.selectPage=function(t){t>0&&t<=e.numPages&&a.slice((t-1)*e.stItemsByPage,e.stItemsByPage)},a.slice(0,e.stItemsByPage)}}})}(angular),function(e){"use strict";e.module("smart-table").directive("stPipe",function(){return{require:"stTable",scope:{stPipe:"="},link:{pre:function(t,r,a,n){e.isFunction(t.stPipe)&&(n.preventPipeOnWatch(),n.pipe=e.bind(n,t.stPipe,n.tableState()))}}}})}(angular),function(e,t){"use strict";e.module("smart-table",[]).run(["$templateCache",function(e){e.put("template/smart-table/pagination.html",'<nav ng-if="numPages && pages.length >= 2"><ul class="pagination"><li ng-repeat="page in pages" ng-class="{active: page==currentPage}"><a href="javascript: void(0);" ng-click="selectPage(page)">{{page}}</a></li></ul></nav>')}]),e.module("smart-table").constant("stConfig",{pagination:{template:"template/smart-table/pagination.html",itemsByPage:10,displayedPages:5},search:{delay:400,inputEvent:"input"},select:{mode:"single",selectedClass:"st-selected"},sort:{ascentClass:"st-sort-ascent",descentClass:"st-sort-descent",descendingFirst:!1,skipNatural:!1,delay:300},pipe:{delay:100}}),e.module("smart-table").controller("stTableController",["$scope","$parse","$filter","$attrs",function(r,a,n,o){function i(e){return e?[].concat(e):[]}function l(){h=i(c(r)),L===!0&&b.pipe()}function s(e,t){if(t.indexOf(".")!=-1){var r=t.split("."),n=r.pop(),o=r.join("."),i=a(o)(e);delete i[n],0==Object.keys(i).length&&s(e,o)}else delete e[t]}var c,u,d,f=o.stTable,p=a(f),g=p.assign,v=n("orderBy"),y=n("filter"),h=i(p(r)),m={sort:{},search:{},pagination:{start:0,totalItemCount:0}},L=!0,b=this;o.stSafeSrc&&(c=a(o.stSafeSrc),r.$watch(function(){var e=c(r);return e&&e.length?e[0]:t},function(e,t){e!==t&&l()}),r.$watch(function(){var e=c(r);return e?e.length:0},function(e,t){e!==h.length&&l()}),r.$watch(function(){return c(r)},function(e,t){
e!==t&&(m.pagination.start=0,l())})),this.sortBy=function(t,r){return m.sort.predicate=t,m.sort.reverse=r===!0,e.isFunction(t)?m.sort.functionName=t.name:delete m.sort.functionName,m.pagination.start=0,this.pipe()},this.search=function(t,r){var n=m.search.predicateObject||{},o=r?r:"$";return t=e.isString(t)?t.trim():t,a(o).assign(n,t),t||s(n,o),m.search.predicateObject=n,m.pagination.start=0,this.pipe()},this.pipe=function(){var e,a=m.pagination;u=m.search.predicateObject?y(h,m.search.predicateObject):h,m.sort.predicate&&(u=v(u,m.sort.predicate,m.sort.reverse)),a.totalItemCount=u.length,a.number!==t&&(a.numberOfPages=u.length>0?Math.ceil(u.length/a.number):1,a.start=a.start>=u.length?(a.numberOfPages-1)*a.number:a.start,e=u.slice(a.start,a.start+parseInt(a.number))),g(r,e||u)},this.select=function(e,a){var n=i(p(r)),o=n.indexOf(e);o!==-1&&("single"===a?(e.isSelected=e.isSelected!==!0,d&&(d.isSelected=!1),d=e.isSelected===!0?e:t):n[o].isSelected=!n[o].isSelected)},this.slice=function(e,t){return m.pagination.start=e,m.pagination.number=t,this.pipe()},this.tableState=function(){return m},this.getFilteredCollection=function(){return u||h},this.setFilterFunction=function(e){y=n(e)},this.setSortFunction=function(e){v=n(e)},this.preventPipeOnWatch=function(){L=!1}}]).directive("stTable",function(){return{restrict:"A",controller:"stTableController",link:function(e,t,r,a){r.stSetFilter&&a.setFilterFunction(r.stSetFilter),r.stSetSort&&a.setSortFunction(r.stSetSort)}}}),e.module("smart-table").directive("stSearch",["stConfig","$timeout","$parse",function(e,t,r){return{require:"^stTable",link:function(a,n,o,i){var l=i,s=null,c=o.stDelay||e.search.delay,u=o.stInputEvent||e.search.inputEvent;o.$observe("stSearch",function(e,t){var r=n[0].value;e!==t&&r&&(i.tableState().search={},l.search(r,e))}),a.$watch(function(){return i.tableState().search},function(e,t){var a=o.stSearch||"$";e.predicateObject&&r(a)(e.predicateObject)!==n[0].value&&(n[0].value=r(a)(e.predicateObject)||"")},!0),n.bind(u,function(e){e=e.originalEvent||e,null!==s&&t.cancel(s),s=t(function(){l.search(e.target.value,o.stSearch||""),s=null},c)})}}}]),e.module("smart-table").directive("stSelectRow",["stConfig",function(e){return{restrict:"A",require:"^stTable",scope:{row:"=stSelectRow"},link:function(t,r,a,n){var o=a.stSelectMode||e.select.mode;r.bind("click",function(){t.$apply(function(){n.select(t.row,o)})}),t.$watch("row.isSelected",function(t){t===!0?r.addClass(e.select.selectedClass):r.removeClass(e.select.selectedClass)})}}}]),e.module("smart-table").directive("stSort",["stConfig","$parse","$timeout",function(r,a,n){return{restrict:"A",require:"^stTable",link:function(o,i,l,s){function c(){m?p=0===p?2:p-1:p++;var t;d=e.isFunction(f(o))||e.isArray(f(o))?f(o):l.stSort,p%3===0&&!!h!=!0?(p=0,s.tableState().sort={},s.tableState().pagination.start=0,t=s.pipe.bind(s)):t=s.sortBy.bind(s,d,p%2===0),null!==L&&n.cancel(L),b<0?t():L=n(t,b)}var u,d=l.stSort,f=a(d),p=0,g=l.stClassAscent||r.sort.ascentClass,v=l.stClassDescent||r.sort.descentClass,y=[g,v],h=l.stSkipNatural!==t?l.stSkipNatural:r.sort.skipNatural,m=l.stDescendingFirst!==t?l.stDescendingFirst:r.sort.descendingFirst,L=null,b=l.stDelay||r.sort.delay;l.stSortDefault&&(u=o.$eval(l.stSortDefault)!==t?o.$eval(l.stSortDefault):l.stSortDefault),i.bind("click",function(){d&&o.$apply(c)}),u&&(p="reverse"===u?1:0,c()),o.$watch(function(){return s.tableState().sort},function(e){e.predicate!==d?(p=0,i.removeClass(g).removeClass(v)):(p=e.reverse===!0?2:1,i.removeClass(y[p%2]).addClass(y[p-1]))},!0)}}}]),e.module("smart-table").directive("stPagination",["stConfig",function(e){return{restrict:"EA",require:"^stTable",scope:{stItemsByPage:"=?",stDisplayedPages:"=?",stPageChange:"&"},templateUrl:function(t,r){return r.stTemplate?r.stTemplate:e.pagination.template},link:function(t,r,a,n){function o(){var e,r,a=n.tableState().pagination,o=1,i=t.currentPage;for(t.totalItemCount=a.totalItemCount,t.currentPage=Math.floor(a.start/a.number)+1,o=Math.max(o,t.currentPage-Math.abs(Math.floor(t.stDisplayedPages/2))),e=o+t.stDisplayedPages,e>a.numberOfPages&&(e=a.numberOfPages+1,o=Math.max(1,e-t.stDisplayedPages)),t.pages=[],t.numPages=a.numberOfPages,r=o;r<e;r++)t.pages.push(r);i!==t.currentPage&&t.stPageChange({newPage:t.currentPage})}t.stItemsByPage=t.stItemsByPage?+t.stItemsByPage:e.pagination.itemsByPage,t.stDisplayedPages=t.stDisplayedPages?+t.stDisplayedPages:e.pagination.displayedPages,t.currentPage=1,t.pages=[],t.$watch(function(){return n.tableState().pagination},o,!0),t.$watch("stItemsByPage",function(e,r){e!==r&&t.selectPage(1)}),t.$watch("stDisplayedPages",o),t.selectPage=function(e){e>0&&e<=t.numPages&&n.slice((e-1)*t.stItemsByPage,t.stItemsByPage)},n.tableState().pagination.number||n.slice(0,t.stItemsByPage)}}}]),e.module("smart-table").directive("stPipe",["stConfig","$timeout",function(t,r){return{require:"stTable",scope:{stPipe:"="},link:{pre:function(a,n,o,i){var l=null;e.isFunction(a.stPipe)&&(i.preventPipeOnWatch(),i.pipe=function(){return null!==l&&r.cancel(l),l=r(function(){a.stPipe(i.tableState(),i)},t.pipe.delay)})},post:function(e,t,r,a){a.pipe()}}}}])}(angular),app.controller("BarCtrl",function(e,t,r){function a(){t.get("data/csv/reportedissues.csv").then(function(t){var r=parseCSV(t.data),a=convertToJSON(r);e.labels=a[0].labels,e.data=a[0].data}).catch(function(e){console.log("Error "+e)})}a(),r(a,3e3,0)}),app.controller("OpenIssuesController",["$scope","$http","$interval",function(e,t,r){function a(){t.get("data/json/keymetrics.json").then(function(t){e.issues=t.data[0].openissues}).catch(function(e){console.log("Error "+e)})}a(),r(a,3e3,0)}]),app.controller("LineCtrl",["$scope","$http","$interval",function(e,t,r){function a(){t.get("data/csv/linedata.csv").then(function(t){var r=parseCSV(t.data),a=convertToJSON(r);e.labels=a[0].labels,e.data=a[0].data}).catch(function(e){console.log("Error "+e)})}a(),r(a,3e3,0),e.onClick=function(e,t){console.log(e,t)},e.datasetOverride=[{yAxisID:"y-axis-1"},{yAxisID:"y-axis-2"}],e.options={scales:{yAxes:[{id:"y-axis-1",type:"linear",display:!0,position:"left"}]}}}]);